<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>预加载+运行时长示例</title>
    <!-- 预加载动画依赖：anime.js -->
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/anime.min.js"></script>
    <!-- 运行时长统计依赖：odometer.js + 样式 -->
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/odometer.min.js"></script>
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/assets/odometer-theme-minimal.css">

    <!-- 预加载动画样式 -->
    <style>
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --preloader-background-color:#202124;
                --preloader-text-color: #fff
            }
        }

        @media (prefers-color-scheme: light) {
            :root {
                --preloader-background-color:#fff;
                --preloader-text-color: #000
            }
        }

        @media (max-width: 600px) {
            .ml13 {
                font-size:2.6rem!important
            }
        }

        .preloader {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
            justify-content: center;
            position: fixed;
            padding: 12px;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: var(--preloader-background-color);
            z-index: 1100;
            transition: opacity .2s ease-in-out
        }

        .ml13 {
            font-size: 3.2rem;
            color: var(--preloader-text-color);
            letter-spacing: -1px;
            font-weight: 500;
            font-family: sans-serif;
            text-align: center
        }

        .ml13 .word {
            display: inline-flex;
            flex-wrap: wrap;
            white-space: nowrap
        }

        .ml13 .letter {
            display: inline-block;
            line-height: 1em
        }

        /* 运行时长统计样式（可选） */
        .runtime-container {
            text-align: center;
            padding: 50px 0;
            font-size: 18px;
            color: #333;
            background-color: #f5f5f5;
            margin-top: 50px;
        }
        .dark .runtime-container {
            color: #eee;
            background-color: #222;
        }
    </style>
</head>
<body>
    <!-- 预加载动画 HTML -->
    <div class="preloader">
        <h2 class="ml13">[HANASAKI] CONNECTED</h2>
    </div>

    <!-- 页面运行时长统计 HTML -->
    <div class="runtime-container">
        花咲一秋项目运行了：
        <span class="odometer" id="runtime_days"></span> 天 
        <span class="odometer" id="runtime_hours"></span> 小时 
        <span class="odometer" id="runtime_minutes"></span> 分钟 
        <span class="odometer" id="runtime_seconds"></span> 秒
    </div>

    <script>
        // ===================== 预加载动画逻辑 =====================
        (function() {
            var textWrapper = document.querySelector('.ml13');
            // 拆分文字为单词
            var words = textWrapper.textContent.trim().split(' ');
            // 清空原有内容
            textWrapper.innerHTML = '';
            // 为每个单词和字母包裹span
            words.forEach(function(word) {
                var wordSpan = document.createElement('span');
                wordSpan.classList.add('word');
                wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
                textWrapper.appendChild(wordSpan);
                textWrapper.appendChild(document.createTextNode(' '));
            });

            // 字母动画
            var animation = anime.timeline({
                loop: true
            }).add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');

            // 适配深色/浅色模式
            let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;
            if (themeStatus === undefined || themeStatus === null) {
                themeStatus = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            }
            if (themeStatus) {
                document.documentElement.style.setProperty('--preloader-background-color', '#202124');
                document.documentElement.style.setProperty('--preloader-text-color', '#fff');
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.style.setProperty('--preloader-background-color', '#fff');
                document.documentElement.style.setProperty('--preloader-text-color', '#000');
            }

            // 页面加载完成后隐藏预加载（兜底）
            window.addEventListener('load', function() {
                setTimeout(hidePreloader, 5000);
            });

            // 隐藏预加载动画
            function hidePreloader() {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function() {
                    preloader.style.display = 'none';
                }, 200);
            }
        })();

        // ===================== 页面运行时长统计逻辑 =====================
        (function() {
            // 此处应改成起始日期
            const blogStartDate = new Date(2025, 9, 28, 0, 0, 0); // YYYY/MM/DD HH:MM:SS

            // 初始化odometer
            function odometer_init() {
                document.querySelectorAll(".odometer").forEach(e => {
                    new Odometer({
                        el: e,
                        format: "( ddd).dd",
                        duration: 200
                    })
                });
            }
            odometer_init();

            // 计算运行时长
            function updateRuntime() {
                const now = new Date();
                const diff = now - blogStartDate; // 毫秒差

                // 转换为天、时、分、秒
                const seconds = Math.floor((diff / 1000) % 60);
                const minutes = Math.floor((diff / (1000 * 60)) % 60);
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));

                // 更新显示
                document.getElementById('runtime_days').innerText = days;
                document.getElementById('runtime_hours').innerText = hours;
                document.getElementById('runtime_minutes').innerText = minutes;
                document.getElementById('runtime_seconds').innerText = seconds;
            }

            // 初始化+每秒更新
            updateRuntime();
            setInterval(updateRuntime, 1000);
        })();
    </script>
</body>
</html>