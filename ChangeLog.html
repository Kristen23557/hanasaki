<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>花咲一秋 - 组件模板</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- 预加载动画依赖 -->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/assets/odometer-theme-minimal.css">
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/anime.min.js"></script>
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/odometer.min.js"></script>
    <!-- APlayer + MetingJS -->
    <link href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    <style>
        /* 字体定义 */
        @font-face {
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow.woff2') format('woff2'), url('fonts/SJ-Narrow-Regular-2.ttf') format('truetype');
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }
        @font-face {
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow-Light.woff2') format('woff2'), url('fonts/SJ-Narrow-Light-2.ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
            font-display: swap;
        }

        /* 基础变量定义 */
        :root {
            --primary-blue: #6a93c9;
            --light-blue: #8fb5e6;
            --dark-blue: #4a6fa5;
            --yellow-accent: #ffcc00;
            --yellow-light: #ffdb4d;
            --gray-bg: #f0f2f5;
            --main-bg: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            --bg-element: rgba(106,147,201,0.05);
            --header-border: rgba(74, 111, 165, 0.1);
            --highlight-bg: rgba(106, 147, 201, 0.1);
            --contact-bg: linear-gradient(135deg, rgba(106, 147, 201, 0.1), rgba(143, 181, 230, 0.1));
            --contact-border: rgba(106, 147, 201, 0.2);
            --contact-divider: rgba(106, 147, 201, 0.1);
            --warning-bg: rgba(255, 100, 100, 0.1);
            --warning-border: #ff6b6b;
            --footer-border: rgba(106, 147, 201, 0.2);
            --icon-bg: rgba(255, 204, 0, 0.1);
            --tag-hover: rgba(255, 204, 0, 0.2);
            --gray-dark: #333333;
            --text-light: #ffffff;
            --text-dark: #2c3e50;
            --text-medium: #4a5568;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
            --text: var(--text-dark);
            --heading-color: var(--dark-blue);
            --muted: rgba(100, 110, 130, 0.7);
        }

        :root[data-theme="dark"] {
            --primary-blue: #5480b8;
            --light-blue: #3b5f8a;
            --dark-blue: #0e2a3f;
            --yellow-accent: #f6c85f;
            --yellow-light: #f7d67a;
            --gray-bg: #0b1220;
            --main-bg: linear-gradient(135deg, #061020 0%, #041018 100%);
            --bg-element: rgba(106,147,201,0.12);
            --header-border: rgba(74, 111, 165, 0.06);
            --highlight-bg: rgba(255,255,255,0.03);
            --contact-bg: linear-gradient(135deg, rgba(10,12,16,0.6), rgba(20,30,40,0.6));
            --contact-border: rgba(255,255,255,0.06);
            --contact-divider: rgba(255,255,255,0.03);
            --warning-bg: rgba(255, 60, 60, 0.08);
            --warning-border: #ff8b8b;
            --footer-border: rgba(255,255,255,0.04);
            --icon-bg: rgba(255, 204, 0, 0.05);
            --tag-hover: rgba(255, 204, 0, 0.08);
            --gray-dark: #e6eefc;
            --text-light: #e6eefc;
            --text-dark: #e6eefc;
            --text-medium: #b9c6d6;
            --card-bg: rgba(10,16,24,0.7);
            --shadow: 0 10px 30px rgba(0,0,0,0.6);
            --shadow-hover: 0 18px 50px rgba(0,0,0,0.7);
            background-color: #05060a;
            --text: var(--text-dark);
            --heading-color: var(--text-dark);
            --muted: rgba(180, 190, 210, 0.7);
        }

        /* 高对比模式 */
        :root[data-theme="high-contrast"] {
            --primary-blue: #0b5fc7;
            --light-blue: #0b5fc7;
            --dark-blue: #05223a;
            --yellow-accent: #ffd43b;
            --gray-bg: #ffffff;
            --main-bg: #ffffff;
            --bg-element: rgba(0,0,0,0.06);
            --header-border: rgba(0,0,0,0.12);
            --highlight-bg: rgba(0,0,0,0.04);
            --contact-bg: linear-gradient(135deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
            --contact-border: rgba(0,0,0,0.12);
            --contact-divider: rgba(0,0,0,0.06);
            --warning-bg: rgba(255,0,0,0.06);
            --warning-border: #c70000;
            --footer-border: rgba(0,0,0,0.12);
            --icon-bg: rgba(0,0,0,0.06);
            --tag-hover: rgba(0,0,0,0.08);
            --gray-dark: #111111;
            --text-light: #111111;
            --text-dark: #111111;
            --text-medium: #333333;
            --card-bg: #ffffff;
            --shadow: 0 6px 18px rgba(0,0,0,0.09);
            --shadow-hover: 0 12px 28px rgba(0,0,0,0.12);
            --text: var(--text-dark);
            --heading-color: var(--text-dark);
        }

        /* 减少动画 */
        .reduced-motion *, .reduced-motion *::before, .reduced-motion *::after {
            animation-duration: 0.001ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.001ms !important;
            scroll-behavior: auto !important;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Chillax-Variable', 'Chillax-Regular', 'Noto Sans SC', 'Segoe UI', sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
            background: var(--main-bg);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* 强制主文案使用 Chillax（排除 font-awesome 图标） */
        body, h1, h2, h3, h4, h5, h6, p, a, span, div, li, input, textarea, select, button {
            font-family: 'Chillax-Variable', 'Chillax-Regular', sans-serif !important;
        }
        /* 保留 Font Awesome 图标字体 */
        .fa, .fas, .far, .fab, i[class^="fa"], span[class^="fa"] {
            font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', sans-serif !important;
            font-weight: 900 !important;
        }

        /* 主要内容容器 */
        .main-content {
            width: 100%;
            min-height: 100vh;
            position: relative;
            overflow-y: auto;
        }

        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            padding-top: 100px; /* 为固定导航栏留出空间 */
        }

        /* 可访问性：焦点可见性 */
        :focus-visible {
            outline: 3px solid var(--yellow-accent);
            outline-offset: 3px;
            border-radius: 6px;
        }

        /* Preloader 样式 */
        :root {
            --preloader-background-color: var(--card-bg);
            --preloader-text-color: var(--text-dark);
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --preloader-background-color: #071018;
                --preloader-text-color: var(--text-light);
            }
        }
        
        .preloader {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
            justify-content: center;
            position: fixed;
            padding: 12px;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: var(--preloader-background-color);
            z-index: 11000;
            transition: opacity .45s ease-in-out !important;
        }
        
        /* 使用 Chillax 字体 */
        .preloader .ml13 {
            font-size: 2.6rem;
            color: var(--preloader-text-color);
            letter-spacing: -1px;
            font-weight: 500;
            font-family: 'Chillax-Variable', 'Chillax-Regular', 'Microsoft YaHei', '微软雅黑', sans-serif;
            text-align: center;
        }
        
        /* 如果 reduced-motion 被启用，仍要允许 preloader 的淡出过渡可见 */
        .reduced-motion .preloader {
            transition: opacity .45s ease-in-out !important;
        }
        
        .preloader .word {
            display: inline-flex;
            flex-wrap: wrap;
            white-space: nowrap;
        }
        
        .preloader .letter {
            display: inline-block;
            line-height: 1em;
        }

        /* 导航栏样式 */
        .navbar-container {
            position: fixed;
            top: 0;
            z-index: 1000;
            width: 100%;
            background-color: var(--card-bg);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, padding 0.3s ease, box-shadow 0.3s ease;
        }
        
        .navbar-container.shrink {
            padding: 0.25rem 0;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
        }
        
        .navbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo-title h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-dark);
            transition: color 0.2s ease;
        }
        
        .logo-title h1:hover {
            color: var(--primary-blue);
        }
        
        /* 桌面端导航 */
        .desktop .navbar-list {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }
        
        .navbar-item a {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-medium);
            text-decoration: none;
            padding: 0.5rem 0;
            position: relative;
            transition: color 0.2s ease;
            font-weight: 400;
        }
        
        .navbar-item a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--primary-blue);
            transition: width 0.3s ease;
        }
        
        .navbar-item a.active,
        .navbar-item a:hover {
            color: var(--primary-blue);
        }
        
        .navbar-item a.active::after,
        .navbar-item a:hover::after {
            width: 100%;
        }
        
        /* 移动端导航 */
        .mobile {
            display: none;
            align-items: center;
            gap: 1rem;
        }
        
        .icon-item {
            color: var(--text-medium);
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 0.5rem;
            border-radius: 50%;
        }
        
        .icon-item:hover {
            color: var(--primary-blue);
            background-color: rgba(0, 0, 0, 0.03);
        }
        
        /* 导航抽屉 */
        .navbar-drawer {
            position: fixed;
            top: 0;
            left: -100%;
            width: 100%;
            max-width: 320px;
            height: 100vh;
            background-color: var(--card-bg);
            z-index: 1001;
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 2rem 1.5rem;
            overflow-y: auto;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
        }
        
        .navbar-drawer.open {
            left: 0;
        }
        
        .drawer-navbar-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .drawer-navbar-item a {
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--text-medium);
            text-decoration: none;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid transparent;
            transition: background-color 0.2s ease;
        }
        
        .drawer-navbar-item a:hover,
        .drawer-navbar-item a.active {
            color: var(--primary-blue);
            background-color: rgba(0, 0, 0, 0.03);
            border-color: rgba(0, 0, 0, 0.06);
        }
        
        /* 遮罩层 */
        .window-mask {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .window-mask.show {
            opacity: 1;
            pointer-events: all;
        }
        
        /* 右下工具容器 */
        .right-side-tools-container {
            position: fixed;
            right: 18px;
            bottom: 120px;
            z-index: 11002;
        }
        
        .side-tools-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .right-bottom-tools {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(0, 0, 0, 0.08);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--text-medium);
            cursor: pointer;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        
        .right-bottom-tools:hover {
            transform: scale(1.06);
            color: #fff;
            background-color: var(--primary-blue);
        }
        
        .hidden-tools-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .hidden-tools-list.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }
        
        .tool-scroll-to-top .percent {
            position: absolute;
            font-size: 0.7rem;
            font-weight: 500;
            color: inherit;
            transition: all 0.2s ease;
        }
        
        @media (max-width: 768px) {
            .desktop {
                display: none;
            }
            
            .mobile {
                display: flex;
            }
            
            .right-side-tools-container {
                right: 18px;
                bottom: 96px;
            }
        }

        /* 运行时长小组件 */
        .widget-stack {
            position: fixed;
            right: 18px;
            bottom: 18px;
            z-index: 11001;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }
        
        .runtime-widget {
            width: 320px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            font-size: 13px;
            color: var(--text);
            overflow: hidden;
        }
        
        .runtime-widget .anniv-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 14px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
            backdrop-filter: blur(2px);
        }
        
        .runtime-widget .anniv-row .anniv-label {
            font-weight: 600;
            color: var(--muted);
        }
        
        .runtime-widget .anniv-row .anniv-count {
            font-weight: 800;
            font-family: 'Chillax-Regular', 'Chillax-Variable', sans-serif;
        }
        
        .runtime-widget .progress-track {
            position: relative;
            height: 64px;
            background: var(--card-bg);
        }
        
        .runtime-widget .progress-fill {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0%;
            transition: width 600ms linear;
            background: linear-gradient(90deg, var(--primary-blue), var(--light-blue));
        }
        
        .runtime-widget .progress-overlay {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 8px 12px;
        }
        
        .runtime-widget .odometer {
            font-weight: 700;
            margin: 0 6px;
            font-family: 'Chillax-Semibold', 'Chillax-Regular', sans-serif;
            font-size: 13px;
        }
        
        .runtime-widget .runtime-label {
            color: var(--muted);
            font-size: 13px;
            margin-right: 8px;
            font-weight: 700;
        }
        
        .runtime-widget .anniv-row .anniv-label {
            font-size: 13px;
            letter-spacing: 0.2px;
            font-weight: 700;
        }
        
        .runtime-widget .anniv-row .anniv-count {
            font-size: 16px;
            margin-left: 12px;
            font-weight: 800;
        }
        
        /* 小弹跳动画 */
        @keyframes pop {
            0% {
                transform: scale(1);
            }
            
            50% {
                transform: scale(1.12);
            }
            
            100% {
                transform: scale(1);
            }
        }
        
        .pop {
            animation: pop 420ms cubic-bezier(.2, .9, .2, 1);
        }
        
        /* 烟花/五彩纸屑 */
        .fw-container {
            position: absolute;
            inset: auto 0 auto 0;
            pointer-events: none;
            z-index: 12000;
            width: 100%;
            height: 0;
        }
        
        .confetti {
            position: absolute;
            width: 8px;
            height: 16px;
            border-radius: 2px;
            opacity: 0;
            transform-origin: center;
        }
        
        @keyframes confettiFall {
            to {
                transform: translateY(140px) rotate(360deg);
                opacity: 0;
            }
        }

        /* 音乐播放器卡片 */
        .music-widget {
            position: fixed;
            right: 18px;
            top: 72px;
            width: 320px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            background: var(--card-bg);
            z-index: 11001;
            transform: translateX(calc(100% - 48px));
            transition: transform 320ms cubic-bezier(.2, .9, .2, 1);
            pointer-events: auto;
            max-height: 70vh;
        }
        
        .music-widget.show,
        .music-widget:hover {
            transform: translateX(0);
        }
        
        .music-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            background: var(--card-bg);
            position: relative;
            z-index: 2;
        }
        
        .music-header .title {
            font-weight: 700;
            font-family: 'Chillax-Semibold', 'Chillax-Regular', sans-serif;
        }
        
        .music-body {
            height: 0;
            overflow: hidden;
            transition: height 320ms ease;
            position: relative;
        }
        
        .music-body.open {
            height: 220px;
            min-height: 220px;
        }
        
        .music-body iframe,
        .music-body .aplayer {
            width: 100%;
            height: 220px;
            border: none;
            display: block;
            position: relative;
            z-index: 1;
        }
        
        /* 音乐弹窗 */
        .music-popup {
            position: fixed;
            right: 22px;
            top: 72px;
            z-index: 11003;
            background: var(--card-bg);
            padding: 10px 12px;
            border-radius: 10px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
            display: block;
            min-width: 240px;
            transform: translateX(calc(100% - 48px));
            opacity: 0;
            pointer-events: none;
            transition: transform 320ms cubic-bezier(.2, .9, .2, 1), opacity 260ms ease;
        }
        
        .music-popup.show {
            transform: translateX(0);
            opacity: 1;
            pointer-events: auto;
        }

        /* 页脚样式 */
        .footer {
            text-align: center;
            padding: 50px 0;
            border-top: 1px solid var(--footer-border);
            color: var(--text-medium);
            font-size: 1rem;
            position: relative;
            z-index: 1;
            margin-top: 60px;
        }
        
        .footer p {
            margin-bottom: 15px;
        }
        
        .footer strong {
            color: var(--dark-blue);
            font-weight: 700;
        }
        
        .social-icons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .social-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            transition: var(--transition);
            text-decoration: none;
        }
        
        .social-icon:hover {
            background-color: var(--yellow-accent);
            transform: translateY(-5px);
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .content-wrapper {
                padding: 30px 15px;
                padding-top: 80px;
            }
            
            .footer {
                padding: 30px 15px;
            }
            
            .runtime-widget {
                width: 280px;
            }
            
            .music-widget {
                width: 280px;
            }
        }

        /* 装饰性元素 - 可选 */
        .bg-elements {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }
        
        .bg-element {
            position: absolute;
            border-radius: 50%;
            background-color: var(--bg-element);
        }
        
        .bg-1 {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
        }
        
        .bg-2 {
            width: 400px;
            height: 400px;
            bottom: -200px;
            left: -200px;
        }
        
        .bg-3 {
            width: 200px;
            height: 200px;
            top: 30%;
            left: 10%;
        }
    </style>
</head>
<body>
    <!-- 预加载动画 -->
    <div class="preloader" id="preloader" role="status" aria-label="页面加载中">
        <h2 class="ml13">[ChangeLog] Loaded</h2>
    </div>

    <!-- 导航栏 -->
    <header class="navbar-container" id="navbarContainer">
        <div class="navbar-content transition-navbar has-home-banner">
            <div class="left">
                <a class="logo-title" href="index.html">
                    <h1>花咲一秋</h1>
                </a>
            </div>
            <div class="right">
                <div class="desktop">
                    <ul class="navbar-list">
                        <li class="navbar-item"><a class="active" href="index.html"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li>
                        <li class="navbar-item"><a href="Documents.html"><i class="fa-regular fa-archive fa-fw"></i> 帮助手册</a></li>
                        <li class="navbar-item"><a href="Thanks.html"><i class="fa-regular fa-hand-holding-heart fa-fw"></i> 感谢名单</a></li>
                        <li class="navbar-item"><a href="index.html#changelog"><i class="fa-regular fa-chart-bar fa-fw"></i> 更新日志</a></li>
                    </ul>
                </div>
                <div class="mobile">
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                    <div class="icon-item navbar-bar" id="navbarBar" role="button" tabindex="0" aria-controls="navbarDrawer" aria-expanded="false"><i class="fa-solid fa-bars"></i></div>
                </div>
            </div>
        </div>
        <div class="navbar-drawer" id="navbarDrawer" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1">
            <ul class="drawer-navbar-list">
                <li class="drawer-navbar-item"><a class="active" href="index.html"><span>首页</span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="Documents.html"><span>帮助手册</span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="Thanks.html"><span>感谢名单</span><i class="fa-regular fa-hand-holding-heart fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="index.html#changelog"><span>更新日志</span><i class="fa-regular fa-chart-bar fa-sm fa-fw"></i></a></li>
            </ul>
        </div>
        <div class="window-mask" id="windowMask" role="presentation" aria-hidden="true"></div>
    </header>

    <!-- 右下角工具栏 -->
    <div class="right-side-tools-container">
        <div class="side-tools-container">
            <ul class="hidden-tools-list" id="hiddenToolsList">
                <li class="right-bottom-tools tool-font-adjust-plus" title="放大字体"><i class="fa-regular fa-magnifying-glass-plus"></i></li>
                <li class="right-bottom-tools tool-font-adjust-minus" title="缩小字体"><i class="fa-regular fa-magnifying-glass-minus"></i></li>
                <li class="right-bottom-tools tool-dark-light-toggle" title="切换明暗主题"><i class="fa-regular fa-moon" id="themeIcon"></i></li>
                <li class="right-bottom-tools tool-scroll-to-bottom" title="滚动到底部"><i class="fa-regular fa-arrow-down"></i></li>
            </ul>
            <ul class="visible-tools-list">
                <li class="right-bottom-tools toggle-tools-list" title="展开/收起工具" id="toggleToolsBtn"><i class="fa-regular fa-cog fa-spin" id="gearIcon"></i></li>
                <li class="right-bottom-tools tool-scroll-to-top" title="回到顶部" id="scrollToTopBtn"><i class="arrow-up fas fa-arrow-up"></i><span class="percent" id="scrollPercent">0%</span></li>
            </ul>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content">
        <!-- 装饰性背景元素（可选） -->
        <div class="bg-elements">
            <div class="bg-element bg-1"></div>
            <div class="bg-element bg-2"></div>
            <div class="bg-element bg-3"></div>
        </div>
        
        <div class="content-wrapper" id="main-wrapper">
            <!-- 这里可以添加你自己的内容 -->
            <h1 style="font-family: 'SJ-Narrow', 'Poppins', sans-serif; font-size: 3rem; margin-bottom: 30px; color: var(--heading-color);">
                欢迎使用花咲一秋组件模板
            </h1>
            <p style="font-size: 1.2rem; margin-bottom: 40px; color: var(--text-medium);">
                这个页面包含了导航栏、运行时长统计、音乐播放器和页脚等核心组件。<br>
                你可以在此基础之上添加自己的内容。
            </p>
            
            <!-- 示例内容区域 -->
            <div style="background-color: var(--card-bg); border-radius: 20px; padding: 40px; margin-bottom: 40px; box-shadow: var(--shadow);">
                <h2 style="font-family: 'SJ-Narrow', sans-serif; margin-bottom: 20px; color: var(--heading-color);">内容区域示例</h2>
                <p style="color: var(--text); line-height: 1.7; margin-bottom: 15px;">
                    这是一个示例内容区域，展示了如何使用卡片样式。你可以在这里添加任何内容，如文本、图片、列表等。
                </p>
                <ul style="color: var(--text-medium); padding-left: 20px; margin-bottom: 20px;">
                    <li style="margin-bottom: 8px;">响应式设计，适配各种屏幕尺寸</li>
                    <li style="margin-bottom: 8px;">支持深色/浅色主题切换</li>
                    <li style="margin-bottom: 8px;">包含音乐播放器和运行时长统计</li>
                    <li style="margin-bottom: 8px;">预加载动画和流畅的过渡效果</li>
                </ul>
                <p style="color: var(--text); line-height: 1.7;">
                    所有样式变量都已定义，你可以轻松自定义颜色、间距和其他设计元素。
                </p>
            </div>
            
            <!-- 页脚 -->
            <footer class="footer">
                <p>© 2025~2026 花咲一秋QQ机器人项目. 保留所有权利.</p>
                <p>本页面由 <strong>卡秋KArabella和支持此项目的早期伙伴们</strong> 开发维护</p>
                <p>本页面仅为介绍页面，机器人功能以实际可用为准</p>
                <p>感谢每一位支持此项目的用户，你们的反馈让小秋变得更好</p>
                
                <div class="social-icons">
                    <a href="#" class="social-icon" aria-label="GitHub">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" class="social-icon" aria-label="QQ">
                        <i class="fab fa-qq"></i>
                    </a>
                    <a href="#" class="social-icon" aria-label="邮箱">
                        <i class="fas fa-envelope"></i>
                    </a>
                    <a href="#" class="social-icon" aria-label="音乐">
                        <i class="fas fa-music"></i>
                    </a>
                </div>
            </footer>
        </div>
    </div>

    <!-- 右上音乐播放器卡片 -->
    <div class="music-widget" id="musicWidget" aria-label="音乐播放器" role="region" aria-hidden="true" tabindex="-1">
        <div class="music-header" id="musicToggle" role="button" aria-expanded="false">
            <div style="display:flex;align-items:center;gap:10px">
                <i class="fa fa-music" aria-hidden="true"></i>
                <div class="title">音乐播放器</div>
            </div>
            <div style="font-size:12px;color:var(--muted)">悬停展开或点击控制</div>
        </div>
        <div class="music-body" id="musicBody">
            <meting-js server="netease" type="playlist" id="5034562952"></meting-js>
        </div>
    </div>

    <!-- 右下运行时长小组件 -->
    <div class="widget-stack" aria-hidden="false">
        <div class="runtime-widget" role="note" aria-label="花咲一秋项目运行与周年进度">
            <div class="anniv-row">
                <div style="display:flex;align-items:center">
                    <div class="anniv-label">周年进度 Anniversary </div>
                    <div id="anniv-count" class="anniv-count">0</div>
                </div>
                <div id="anniv-percent" style="font-size:14px;color:var(--muted);font-weight:700">0%</div>
            </div>
            <div class="progress-track" aria-hidden="true">
                <div id="anniv-fill" class="progress-fill" style="width:0%"></div>
                <div class="progress-overlay">
                    <div style="display:flex;align-items:center;gap:8px">
                        <span class="runtime-label"></span>
                        <span id="runtime_days" class="odometer">0</span>
                        <span class="runtime-label">d</span>
                        <span id="runtime_hours" class="odometer">0</span>
                        <span class="runtime-label">h</span>
                        <span id="runtime_minutes" class="odometer">0</span>
                        <span class="runtime-label">m</span>
                        <span id="runtime_seconds" class="odometer">0</span>
                        <span class="runtime-label">s</span>
                    </div>
                </div>
            </div>
            <div class="fw-container" id="fw"></div>
        </div>
    </div>

    <script>
        // 在 CSS 之前设置主题属性，避免闪烁
        (function() {
            try {
                var stored = localStorage.getItem('theme');
                var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                var use = stored || (prefersDark ? 'dark' : 'light');
                if (use === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
            } catch (e) {}
        })();

        // 可访问性：减少动画偏好
        (function() {
            const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
            if (mq.matches) {
                document.documentElement.classList.add('reduced-motion');
            }
            mq.addEventListener && mq.addEventListener('change', (e) => {
                if (e.matches) document.documentElement.classList.add('reduced-motion');
                else document.documentElement.classList.remove('reduced-motion');
            });
        })();

        // ===================== 预加载动画逻辑 =====================
        (function() {
            try {
                var textWrapper = document.querySelector('.preloader .ml13');
                if (textWrapper) {
                    var words = textWrapper.textContent.trim().split(' ');
                    textWrapper.innerHTML = '';
                    words.forEach(function(word) {
                        var wordSpan = document.createElement('span');
                        wordSpan.className = 'word';
                        wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
                        textWrapper.appendChild(wordSpan);
                        textWrapper.appendChild(document.createTextNode(' '));
                    });

                    // Respect prefers-reduced-motion
                    var reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                    if (reduceMotion) {
                        // reveal letters statically and hide preloader shortly
                        var letters = document.querySelectorAll('.preloader .letter');
                        letters.forEach(function(l) {
                            l.style.opacity = '1';
                            l.style.transform = 'translateY(0)';
                        });
                        setTimeout(function() {
                            try {
                                hidePreloader();
                            } catch (e) {}
                        }, 700);
                    } else {
                        var animation = anime.timeline({
                                loop: true
                            })
                            .add({
                                targets: '.preloader .letter',
                                translateY: [20, 0],
                                translateZ: 0,
                                opacity: [0, 1],
                                filter: ['blur(5px)', 'blur(0px)'],
                                easing: 'easeOutExpo',
                                duration: 1200,
                                delay: (el, i) => 300 + 20 * i,
                            })
                            .add({
                                targets: '.preloader .letter',
                                translateY: [0, -20],
                                opacity: [1, 0],
                                filter: ['blur(0px)', 'blur(5px)'],
                                easing: 'easeInExpo',
                                duration: 1000,
                                delay: (el, i) => 15 * i,
                                complete: function() {
                                    try {
                                        hidePreloader();
                                    } catch (e) {}
                                }
                            }, '-=700');
                    }
                }
            } catch (e) {
                console.error(e)
            }

            // 隐藏 preloader 的兜底逻辑
            function hidePreloader() {
                var el = document.getElementById('preloader');
                if (!el) return;
                el.style.opacity = '0';
                setTimeout(function() {
                    el.style.display = 'none';
                }, 400);
            }
            window.addEventListener('load', function() {
                setTimeout(hidePreloader, 5000);
            });
            // 10s 兜底
            setTimeout(hidePreloader, 10000);
        })();

        // ===================== 运行时长统计 =====================
        (function() {
            const blogStartDate = new Date(2025, 9, 28, 0, 0, 0); // 起始日期
            let lastAnnivCount = null;

            function odometer_init() {
                document.querySelectorAll('.odometer').forEach(e => {
                    try {
                        new Odometer({
                            el: e,
                            format: '(ddd)',
                            duration: 200
                        });
                    } catch (err) {}
                });
            }

            function animateNumber(el) {
                if (!el) return;
                el.classList.remove('pop');
                // force reflow
                void el.offsetWidth;
                el.classList.add('pop');
                setTimeout(() => el.classList.remove('pop'), 600);
            }

            function playFireworks() {
                const container = document.getElementById('fw');
                if (!container) return;
                const colors = ['#ff5e7f', '#ffd166', '#8fd3ff', '#9be28f', '#d6a4ff'];
                const count = 18;
                for (let i = 0; i < count; i++) {
                    const n = document.createElement('div');
                    n.className = 'confetti';
                    n.style.left = (20 + Math.random() * 280) + 'px';
                    n.style.top = (8 + Math.random() * 30) + 'px';
                    n.style.background = colors[Math.floor(Math.random() * colors.length)];
                    n.style.opacity = '1';
                    const dur = 900 + Math.floor(Math.random() * 600);
                    n.style.transition = `transform ${dur}ms cubic-bezier(.2,.8,.2,1), opacity ${dur}ms linear`;
                    container.appendChild(n);
                    // trigger animation
                    setTimeout(() => {
                        const tx = (Math.random() * 160 - 80) + 'px';
                        n.style.transform = `translate(${tx}, ${120 + Math.random() * 40}px) rotate(${Math.random() * 720}deg)`;
                        n.style.opacity = '0';
                    }, 10 + Math.random() * 80);
                    // cleanup
                    setTimeout(() => {
                        try {
                            container.removeChild(n);
                        } catch (e) {}
                    }, dur + 250);
                }
            }

            function updateRuntimeAndAnniv() {
                const now = new Date();
                const diff = now - blogStartDate;
                const seconds = Math.floor((diff / 1000) % 60);
                const minutes = Math.floor((diff / (1000 * 60)) % 60);
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const d = document.getElementById('runtime_days');
                const h = document.getElementById('runtime_hours');
                const m = document.getElementById('runtime_minutes');
                const s = document.getElementById('runtime_seconds');
                if (d && String(d.innerText) !== String(days)) {
                    d.innerText = days;
                    animateNumber(d);
                }
                if (h && String(h.innerText) !== String(hours)) {
                    h.innerText = hours;
                    animateNumber(h);
                }
                if (m && String(m.innerText) !== String(minutes)) {
                    m.innerText = minutes;
                    animateNumber(m);
                }
                if (s && String(s.innerText) !== String(seconds)) {
                    s.innerText = seconds;
                    animateNumber(s);
                }

                // Anniversary progress
                const start = new Date(blogStartDate.getTime());
                let years = now.getFullYear() - start.getFullYear();
                let last = new Date(start.getTime());
                last.setFullYear(start.getFullYear() + years);
                if (now < last) {
                    years -= 1;
                    last.setFullYear(start.getFullYear() + years);
                }
                const next = new Date(last.getTime());
                next.setFullYear(last.getFullYear() + 1);
                const annivCount = Math.max(0, years);
                const annivEl = document.getElementById('anniv-count');
                if (annivEl && String(annivEl.textContent) !== String(annivCount)) {
                    annivEl.textContent = annivCount;
                    animateNumber(annivEl);
                }
                const fillEl = document.getElementById('anniv-fill');
                if (fillEl) {
                    const total = next - last;
                    const elapsed = now - last;
                    const pct = total > 0 ? Math.max(0, Math.min(1, elapsed / total)) : 0;
                    fillEl.style.width = (pct * 100) + '%';
                    // 更新百分比显示
                    const pctEl = document.getElementById('anniv-percent');
                    if (pctEl) pctEl.textContent = (pct * 100).toFixed(2) + '%';
                    const colors = ['#6a93c9', '#ffcc66', '#8fd3ff', '#ff99cc', '#9be28f', '#d6a4ff'];
                    const color = colors[annivCount % colors.length];
                    fillEl.style.background = color;
                }

                // detect anniversary crossing while page open
                if (lastAnnivCount === null) lastAnnivCount = annivCount;
                else if (annivCount > lastAnnivCount) {
                    // celebrate
                    playFireworks();
                    lastAnnivCount = annivCount;
                } else {
                    lastAnnivCount = annivCount;
                }
            }

            document.addEventListener('DOMContentLoaded', () => {
                odometer_init();
                updateRuntimeAndAnniv();
                setInterval(updateRuntimeAndAnniv, 1000);
                
                // 初始化 Meting/APlayer
                (function initMetingPlayer() {
                    const FLAG = 'hanasaki_music_autoplay_v1';
                    const metingEl = document.querySelector('meting-js');
                    if (!metingEl) return;

                    function escapeHtmlLocal(s) {
                        return String(s || '').replace(/[&<>"']/g, c => ({
                            '&': '&amp;',
                            '<': '&lt;',
                            '>': '&gt;',
                            '"': '&quot;',
                            "'": '&#39;'
                        }[c]));
                    }

                    function showMusicPopup(track, opts) {
                        if (!track) return;
                        opts = opts || {};
                        const title = track.name || track.title || '未知曲目';
                        const artist = (track.artist && (typeof track.artist === 'string' ? track.artist : Array.isArray(track.artist) ? track.artist.map(a => a.name || a).join(', ') : JSON.stringify(track.artist))) || track.author || '';
                        const popup = document.getElementById('musicPopup') || (function() {
                            const p = document.createElement('div');
                            p.id = 'musicPopup';
                            p.className = 'music-popup';
                            document.body.appendChild(p);
                            return p;
                        })();
                        // clear any previous hide timer
                        try {
                            if (popup.__hideTimer) {
                                clearTimeout(popup.__hideTimer);
                                popup.__hideTimer = null;
                            }
                        } catch (e) {}
                        
                        popup.innerHTML = `<div style="font-weight:700;margin-bottom:6px">即将播放：${escapeHtmlLocal(title)}</div><div style="font-size:13px;color:var(--muted)">演唱/作者：${escapeHtmlLocal(artist||'未知')}</div>`;
                        
                        if (opts.showEnableBtn) {
                            const btn = document.createElement('button');
                            btn.className = 'music-enable-btn';
                            btn.style.cssText = 'margin-top:8px;padding:8px 10px;border-radius:8px;border:none;background:var(--primary-blue);color:#fff;cursor:pointer';
                            btn.textContent = '启用声音并播放';
                            btn.addEventListener('click', () => {
                                try {
                                    const m = document.querySelector('meting-js');
                                    const a = m && (m.aplayer || m._aplayer || (window.APlayer && window.APlayer.instances && window.APlayer.instances[0]));
                                    if (a && typeof a.play === 'function') {
                                        a.play().catch(() => {});
                                    }
                                    popup.classList.remove('show');
                                    const widget = document.querySelector('.music-widget');
                                    if (widget) widget.classList.remove('show');
                                } catch (e) {}
                            });
                            popup.appendChild(btn);
                        }
                        
                        // force reflow before adding class to ensure CSS transition applies
                        void popup.offsetWidth;
                        popup.classList.add('show');
                        if (!opts.persistent) {
                            popup.__hideTimer = setTimeout(() => {
                                try {
                                    popup.classList.remove('show');
                                    const widget = document.querySelector('.music-widget');
                                    if (widget) widget.classList.remove('show');
                                } catch (e) {}
                            }, opts.timeout || 3000);
                        }
                    }

                    function whenAPlayerReady(cb) {
                        const a = metingEl.aplayer || metingEl._aplayer || (window.APlayer && window.APlayer.instances && window.APlayer.instances[0]);
                        if (!a) return setTimeout(() => whenAPlayerReady(cb), 200);
                        // wait for list
                        if (!a.list || a.list.length === 0) return setTimeout(() => whenAPlayerReady(cb), 200);
                        cb(a);
                    }

                    whenAPlayerReady((a) => {
                        // 设置默认音量为 15%
                        try {
                            if (typeof a.setVolume === 'function') a.setVolume(0.15);
                            else if (typeof a.volume === 'function') a.volume(0.15);
                            else if (a.audio) a.audio.volume = 0.15;
                        } catch (e) {}

                        // 监听列表变化，修复下一首信息显示问题
                        try {
                            if (typeof a.on === 'function') {
                                let nextTrackInfo = null;
                                
                                // 监听播放事件
                                a.on('play', () => {
                                    try {
                                        const idx = a.index || 0;
                                        const t = (a.list && a.list[idx]) || {};
                                        const widget = document.querySelector('.music-widget');
                                        if (widget) {
                                            widget.classList.add('show');
                                            try {
                                                trapFocusIn && trapFocusIn(widget);
                                            } catch (e) {}
                                        }
                                        showMusicPopup(t);
                                    } catch (e) {}
                                });
                                
                                // 监听列表切换事件，提前获取下一首信息
                                a.on('listswitch', (e) => {
                                    try {
                                        const idx = e.index || 0;
                                        const t = (a.list && a.list[idx]) || {};
                                        nextTrackInfo = t;
                                    } catch (e) {}
                                });
                                
                                // 监听切换歌曲事件
                                a.on('switch', (e) => {
                                    try {
                                        const idx = e.index || 0;
                                        const t = (a.list && a.list[idx]) || {};
                                        const widget = document.querySelector('.music-widget');
                                        if (widget) {
                                            widget.classList.add('show');
                                        }
                                        showMusicPopup(t);
                                    } catch (e) {}
                                });
                            }
                        } catch (e) {}

                        // 首次访问随机播放一次
                        try {
                            if (!localStorage.getItem(FLAG)) {
                                const count = a.list.length || 1;
                                const rnd = Math.floor(Math.random() * count);
                                try {
                                    a.index = rnd;
                                } catch (e) {}
                                try {
                                    if (typeof a.switch === 'function') a.switch(rnd);
                                } catch (e) {}
                                // 尝试播放并根据 Promise 结果决定是否展示启用按钮
                                var playResult = null;
                                try {
                                    playResult = (typeof a.play === 'function') ? a.play() : null;
                                } catch (e) {}
                                const t = (a.list && a.list[rnd]) || {};
                                const widget = document.querySelector('.music-widget');
                                if (widget) widget.classList.add('show');
                                if (playResult && typeof playResult.then === 'function') {
                                    playResult.then(function() {
                                        showMusicPopup(t);
                                    }).catch(function() {
                                        showMusicPopup(t, {
                                            persistent: true,
                                            showEnableBtn: true,
                                            timeout: 0
                                        });
                                    });
                                } else {
                                    showMusicPopup(t);
                                }
                                localStorage.setItem(FLAG, '1');
                            }
                        } catch (e) {}

                        // widget control
                        const widget = document.getElementById('musicWidget');
                        const body = document.getElementById('musicBody');
                        const headerToggle = document.getElementById('musicToggle');
                        if (headerToggle && widget && body) {
                            function toggleMusicWidget() {
                                if (!body || !widget) return;
                                const open = body.classList.toggle('open');
                                if (open) {
                                    widget.classList.add('show');
                                    widget.setAttribute('aria-hidden', 'false');
                                } else {
                                    widget.classList.remove('show');
                                    widget.setAttribute('aria-hidden', 'true');
                                }
                                headerToggle.setAttribute('aria-expanded', open ? 'true' : 'false');
                            }
                            headerToggle.addEventListener('click', toggleMusicWidget);
                            headerToggle.addEventListener('keydown', (e) => {
                                if (e.key === 'Enter' || e.key === ' ') {
                                    e.preventDefault();
                                    toggleMusicWidget();
                                }
                            });
                        }
                    });
                })();
            });
        })();

        // 导航栏交互
        document.addEventListener('DOMContentLoaded', () => {
            const navbarContainer = document.getElementById('navbarContainer');
            const navbarBar = document.getElementById('navbarBar');
            const navbarDrawer = document.getElementById('navbarDrawer');
            const windowMask = document.getElementById('windowMask');
            const toggleToolsBtn = document.getElementById('toggleToolsBtn');
            const hiddenToolsList = document.getElementById('hiddenToolsList');
            const gearIcon = document.getElementById('gearIcon');

            function openDrawer() {
                if (!navbarDrawer) return;
                navbarDrawer.classList.add('open');
                navbarDrawer.setAttribute('aria-hidden', 'false');
                navbarBar && navbarBar.setAttribute('aria-expanded', 'true');
                windowMask && windowMask.classList.add('show');
                windowMask && windowMask.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden';
                // anime animation
                try {
                    anime({
                        targets: navbarDrawer,
                        translateX: [-100, 0],
                        opacity: [0, 1],
                        duration: 300,
                        easing: 'easeOutExpo'
                    });
                } catch (e) {}
                // focus management
                setTimeout(() => {
                    trapFocusIn(navbarDrawer);
                }, 10);
            }

            function closeDrawer() {
                if (!navbarDrawer) return;
                try {
                    anime({
                        targets: navbarDrawer,
                        translateX: [0, -100],
                        opacity: [1, 0],
                        duration: 250,
                        easing: 'easeInExpo',
                        complete: () => {
                            navbarDrawer.classList.remove('open');
                            navbarDrawer.setAttribute('aria-hidden', 'true');
                            navbarBar && navbarBar.setAttribute('aria-expanded', 'false');
                            windowMask && windowMask.classList.remove('show');
                            windowMask && windowMask.setAttribute('aria-hidden', 'true');
                            document.body.style.overflow = '';
                        }
                    });
                } catch (e) {
                    navbarDrawer.classList.remove('open');
                    navbarDrawer.setAttribute('aria-hidden', 'true');
                    navbarBar && navbarBar.setAttribute('aria-expanded', 'false');
                    windowMask && windowMask.classList.remove('show');
                    windowMask && windowMask.setAttribute('aria-hidden', 'true');
                    document.body.style.overflow = '';
                }
                // restore focus to navbarBar
                try {
                    navbarBar && navbarBar.focus();
                } catch (e) {}
            }

            function toggleDrawer() {
                if (navbarDrawer && navbarDrawer.classList.contains('open')) closeDrawer();
                else openDrawer();
            }

            // 绑定导航栏事件
            if (navbarBar) {
                navbarBar.addEventListener('click', toggleDrawer);
                navbarBar.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleDrawer();
                    }
                });
            }

            // 工具列表切换
            if (toggleToolsBtn) {
                toggleToolsBtn.addEventListener('click', () => {
                    const isShowing = hiddenToolsList.classList.contains('show');
                    if (isShowing) {
                        hiddenToolsList.classList.remove('show');
                        gearIcon.classList.remove('fa-spin');
                    } else {
                        hiddenToolsList.classList.add('show');
                        gearIcon.classList.add('fa-spin');
                    }
                });
            }

            // 滚动百分比
            const scrollPercent = document.getElementById('scrollPercent');
            window.addEventListener("scroll", () => {
                const scrollTop = window.scrollY || window.pageYOffset;
                const scrollHeight = Math.max(0, document.body.scrollHeight - window.innerHeight);
                const percent = scrollHeight > 0 ? Math.round((scrollTop / scrollHeight) * 100) : 0;
                if (scrollPercent) {
                    const prev = parseInt(String(scrollPercent.textContent).replace(/[^0-9\-]/g, '')) || 0;
                    const obj = {
                        v: prev
                    };
                    anime({
                        targets: obj,
                        v: percent,
                        round: 1,
                        duration: 220,
                        easing: 'easeOutExpo',
                        update: function() {
                            scrollPercent.textContent = obj.v + '%';
                        }
                    });
                    scrollPercent.style.opacity = percent === 0 ? '0' : '1';
                }
            });

            // 滚动到顶部按钮
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            if (scrollToTopBtn) {
                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
            }

            // 全局 ESC 关闭抽屉和音乐播放器
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (navbarDrawer && navbarDrawer.classList.contains('open')) {
                        closeDrawer();
                    }
                    const musicWidget = document.getElementById('musicWidget');
                    const musicBody = document.getElementById('musicBody');
                    if (musicBody && musicBody.classList.contains('open')) {
                        musicBody.classList.remove('open');
                        if (musicWidget) {
                            musicWidget.classList.remove('show');
                            musicWidget.setAttribute('aria-hidden', 'true');
                        }
                    }
                }
            });
        });

        // Global focus-trap utility
        function trapFocusIn(container) {
            if (!container) return;
            try {
                var previous = document.activeElement;
                var focusables = container.querySelectorAll('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
                if (!focusables || focusables.length === 0) return;
                focusables[0].focus();
                var first = focusables[0];
                var last = focusables[focusables.length - 1];

                function keyHandler(e) {
                    if (e.key === 'Tab') {
                        if (e.shiftKey && document.activeElement === first) {
                            e.preventDefault();
                            last.focus();
                        } else if (!e.shiftKey && document.activeElement === last) {
                            e.preventDefault();
                            first.focus();
                        }
                    } else if (e.key === 'Escape' || e.key === 'Esc') {
                        e.preventDefault();
                        try {
                            container.classList.remove('open');
                            container.classList.remove('show');
                        } catch (err) {}
                        document.removeEventListener('keydown', keyHandler);
                    }
                }
                document.addEventListener('keydown', keyHandler);
                var mo = new MutationObserver(function() {
                    if (!container.classList.contains('open') && !container.classList.contains('show')) {
                        try {
                            document.removeEventListener('keydown', keyHandler);
                        } catch (e) {}
                        mo.disconnect();
                    }
                });
                mo.observe(container, {
                    attributes: true,
                    attributeFilter: ['class']
                });
            } catch (e) {}
        }
    </script>
</body>
</html>