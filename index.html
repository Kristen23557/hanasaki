<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>花咲一秋</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- 引入 Chillax 字体（本地优先） -->
    <link rel="stylesheet" href="fonts/Chillax_Complete/Fonts/WEB/css/chillax.css">
    <!-- 预加载动画与运行时长依赖（用于预加载动画与运行时长计数） -->
    <link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/assets/odometer-theme-minimal.css">
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/anime.min.js"></script>
    <script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/odometer.min.js"></script>
    <!-- APlayer + MetingJS: 使用 CDN 引入 APlayer，并加载 MetingJS 以便使用 <meting-js> 标签 -->
    <link href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
    <!-- 优先使用 woff2，若无则回退到 ttf；font-display:swap 提升可见性 -->
    <style>
        @font-face{
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow.woff2') format('woff2'), url('fonts/SJ-Narrow-Regular-2.ttf') format('truetype');
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }
        @font-face{
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow-Light.woff2') format('woff2'), url('fonts/SJ-Narrow-Light-2.ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
            font-display: swap;
        }

    <script>
        // Ensure music header toggle/hover bindings are reliable (bind immediately or retry until available)
        (function bindMusicWidget(){
            var header = document.getElementById('musicToggle');
            var body = document.getElementById('musicBody');
            var widget = document.getElementById('musicWidget');
            if(!header || !body || !widget){
                // elements not ready yet — try again shortly (but avoid infinite loop)
                if(document.readyState === 'complete' || document.readyState === 'interactive'){
                    // if DOM is ready but elements missing, give up
                    return;
                }
                setTimeout(bindMusicWidget, 120);
                return;
            }
            // avoid double-binding
            if(header.dataset.musicBound === '1') return; header.dataset.musicBound = '1';
            var releaseTrap = function(){};
            function openWidget(){
                try{ body.classList.add('open'); widget.classList.add('show'); widget.setAttribute('aria-hidden','false');
                    if(typeof trapFocusIn === 'function'){ try{ releaseTrap(); }catch(e){} releaseTrap = trapFocusIn(widget) || function(){}; }
                }catch(e){}
            }
            function closeWidget(){
                try{ body.classList.remove('open'); widget.classList.remove('show'); widget.setAttribute('aria-hidden','true');
                    try{ releaseTrap(); }catch(e){} releaseTrap = function(){};
                }catch(e){}
            }
            header.addEventListener('click', function(){ if(body.classList.contains('open')) closeWidget(); else openWidget(); header.setAttribute('aria-expanded', body.classList.contains('open') ? 'true' : 'false'); });
            header.addEventListener('keydown', function(e){ if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); header.click(); } });
            // hover reveal behavior
            var leaveTimer = null;
            widget.addEventListener('mouseenter', function(){ clearTimeout(leaveTimer); widget.classList.add('show'); widget.setAttribute('aria-hidden','false'); });
            widget.addEventListener('mouseleave', function(){ leaveTimer = setTimeout(function(){ if(body && !body.classList.contains('open')){ closeWidget(); } }, 420); });
            // global ESC to close widget if open
            document.addEventListener('keydown', function(e){ if(e.key === 'Escape'){ if(body && body.classList.contains('open')){ closeWidget(); } } });
        })();
    </script>
    </style>
    <style>
        /* Preloader & runtime widget styles (adapted) */
        :root{ --preloader-background-color: var(--card-bg); --preloader-text-color: var(--text-dark); }
        @media (prefers-color-scheme: dark){ :root{ --preloader-background-color:#071018; --preloader-text-color:var(--text-light); } }
        .preloader{ display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:11000;transition:opacity .45s ease-in-out !important }
        /* 使用 Chillax 字体（用户指定），回退到系统无衬线 */
        .preloader .ml13{ font-size:2.6rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:'Chillax-Variable','Chillax-Regular','Microsoft YaHei','微软雅黑', sans-serif;text-align:center }
        /* 如果 reduced-motion 被启用，仍要允许 preloader 的淡出过渡可见（覆盖全局 reduced-motion 规则） */
        .reduced-motion .preloader{ transition:opacity .45s ease-in-out !important; }
        .preloader .word{ display:inline-flex;flex-wrap:wrap;white-space:nowrap }
        .preloader .letter{ display:inline-block;line-height:1em }
        /* 运行时长小组件，固定右下 */
        /* 运行时长小组件（进度卡片） */
        .runtime-widget{ position:fixed; right:18px; bottom:18px; z-index:11001; width:320px; border-radius:12px; box-shadow:var(--shadow); font-size:13px; color:var(--text); overflow:hidden; }
        .runtime-widget .anniv-row{ display:flex; align-items:center; justify-content:space-between; padding:10px 14px; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); backdrop-filter: blur(2px); }
        .runtime-widget .anniv-row .anniv-label{ font-weight:600; color:var(--muted); }
        .runtime-widget .anniv-row .anniv-count{ font-weight:800; font-family:'Chillax-Regular','Chillax-Variable',sans-serif; }
        .runtime-widget .progress-track{ position:relative; height:64px; background:var(--card-bg); }
        .runtime-widget .progress-fill{ position:absolute; left:0; top:0; bottom:0; width:0%; transition:width 600ms linear; background:linear-gradient(90deg,var(--primary-blue),var(--light-blue)); }
        .runtime-widget .progress-overlay{ position:relative; z-index:2; display:flex; align-items:center; justify-content:center; height:100%; padding:8px 12px; }
        .runtime-widget .odometer{ font-weight:700; margin:0 6px; font-family:'Chillax-Semibold','Chillax-Regular',sans-serif; font-size:13px; }
        .runtime-widget .runtime-label{ color:var(--muted); font-size:13px; margin-right:8px; font-weight:700 }
        /* widget stack: music + runtime */
        .widget-stack{ position:fixed; right:18px; bottom:18px; z-index:11001; display:flex; flex-direction:column; gap:10px; align-items:flex-end; }
        .music-widget{ width:320px; border-radius:12px; overflow:hidden; box-shadow:var(--shadow); background:var(--card-bg); }
        .music-header{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px 12px; cursor:pointer }
        .music-header .title{ font-weight:700; font-family:'Chillax-Semibold','Chillax-Regular',sans-serif }
        .music-body{ height:0; overflow:hidden; transition:height 360ms ease; }
        .music-body.open{ height:220px; }
        .music-body iframe{ width:100%; height:220px; border:none; display:block }
        /* 将播放器常态隐藏为靠右边缘，仅展示卡片左侧小边距；滑出/滑入使用 transform: translateX 动画 */
        .music-widget{ position:fixed; right:18px; top:72px; width:320px; border-radius:12px; overflow:hidden; box-shadow:var(--shadow); background:var(--card-bg); z-index:11001; transform: translateX(calc(100% - 48px)); transition:transform 320ms cubic-bezier(.2,.9,.2,1); pointer-events:auto }
        /* 当鼠标移入 widget 或通过 JS 添加 .show 时滑出到视口内 */
        .music-widget.show, .music-widget:hover{ transform: translateX(0); }
        /* 小型折叠状态 body */
        .music-body{ height:0; overflow:hidden; transition:height 320ms ease }
        .music-body.open{ height:220px }
        .music-popup{ position:fixed; right:22px; top:72px; z-index:11003; background:var(--card-bg); padding:10px 12px; border-radius:10px; box-shadow:0 12px 30px rgba(0,0,0,0.12); display:block; min-width:240px; transform: translateX(calc(100% - 48px)); opacity:0; pointer-events:none; transition: transform 320ms cubic-bezier(.2,.9,.2,1), opacity 260ms ease; }
        .music-popup.show{ transform: translateX(0); opacity:1; pointer-events:auto }
        /* ensure numbers fit: keep moderate size; labels are bold */
        .runtime-widget .anniv-row .anniv-label{ font-size:13px; letter-spacing:0.2px; font-weight:700 }
        .runtime-widget .anniv-row .anniv-count{ font-size:16px; margin-left:12px; font-weight:800 }
        /* small pop animation when numbers change */
        @keyframes pop { 0%{ transform:scale(1); } 50%{ transform:scale(1.12); } 100%{ transform:scale(1); } }
        .pop { animation: pop 420ms cubic-bezier(.2,.9,.2,1); }
        /* fireworks/confetti */
        .fw-container{ position:absolute; inset:auto 0 auto 0; pointer-events:none; z-index:12000; width:100%; height:0; }
        .confetti{ position:absolute; width:8px; height:16px; border-radius:2px; opacity:0; transform-origin:center; }
        @keyframes confettiFall { to { transform: translateY(140px) rotate(360deg) ; opacity:0 } }
    </style>
    <script>
        // 在 CSS 之前设置主题属性，避免闪烁
        //Null-Qwerty's Blog可以学习参考
        (function(){
            try{
                var stored = localStorage.getItem('theme');
                var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                var use = stored || (prefersDark ? 'dark' : 'light');
                if(use === 'dark') document.documentElement.setAttribute('data-theme','dark');
            }catch(e){}
        })();

        // 可访问性：减少动画偏好（Index 页面）
        (function(){
            const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
            if(mq.matches){ document.documentElement.classList.add('reduced-motion'); }
            mq.addEventListener && mq.addEventListener('change', (e)=>{ if(e.matches) document.documentElement.classList.add('reduced-motion'); else document.documentElement.classList.remove('reduced-motion'); });
        })();

        // 观察器：为 index 页面卡片添加入场触发（插入后绑定）
        (function(){
            const obs = new IntersectionObserver((entries)=>{
                entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('in-view'); obs.unobserve(e.target); } });
            },{threshold:0.12});
            const attach = ()=>{ const cards = document.querySelectorAll('.feature-card'); if(cards.length){ cards.forEach(c=>obs.observe(c)); } else setTimeout(attach,120); };
            attach();
        })();
    </script>
        <script>
            // Enhanced navbar + tools interactions (anime.js-driven) with accessibility (keyboard, focus trap)
            document.addEventListener('DOMContentLoaded', ()=>{
                const navbarContainer = document.getElementById('navbarContainer');
                const navbarBar = document.getElementById('navbarBar');
                const navbarDrawer = document.getElementById('navbarDrawer');
                const windowMask = document.getElementById('windowMask');
                const toggleToolsBtn = document.getElementById('toggleToolsBtn');
                const hiddenToolsList = document.getElementById('hiddenToolsList');
                const gearIcon = document.getElementById('gearIcon');

                function openDrawer(){
                    if(!navbarDrawer) return;
                    navbarDrawer.classList.add('open');
                    navbarDrawer.setAttribute('aria-hidden','false');
                    navbarBar && navbarBar.setAttribute('aria-expanded','true');
                    windowMask && windowMask.classList.add('show');
                    windowMask && windowMask.setAttribute('aria-hidden','false');
                    document.body.style.overflow = 'hidden';
                    // anime animation
                    try{ anime({ targets: navbarDrawer, translateX: [-100, 0], opacity: [0,1], duration: 300, easing: 'easeOutExpo' }); }catch(e){}
                    // focus management: focus first focusable in drawer
                    setTimeout(()=>{ trapFocusIn(navbarDrawer); }, 10);
                }

                function closeDrawer(){
                    if(!navbarDrawer) return;
                    try{ anime({ targets: navbarDrawer, translateX: [0, -100], opacity: [1,0], duration: 250, easing: 'easeInExpo', complete: ()=>{ navbarDrawer.classList.remove('open'); navbarDrawer.setAttribute('aria-hidden','true'); navbarBar && navbarBar.setAttribute('aria-expanded','false'); windowMask && windowMask.classList.remove('show'); windowMask && windowMask.setAttribute('aria-hidden','true'); document.body.style.overflow = ''; } }); }catch(e){ navbarDrawer.classList.remove('open'); navbarDrawer.setAttribute('aria-hidden','true'); navbarBar && navbarBar.setAttribute('aria-expanded','false'); windowMask && windowMask.classList.remove('show'); windowMask && windowMask.setAttribute('aria-hidden','true'); document.body.style.overflow = ''; }
                    // restore focus to navbarBar
                    try{ navbarBar && navbarBar.focus(); }catch(e){}
                }

                function toggleDrawer(){ if(navbarDrawer && navbarDrawer.classList.contains('open')) closeDrawer(); else openDrawer(); }

                // focus trap utility (basic)
                let previousFocus = null;
                function trapFocusIn(container){ if(!container) return; previousFocus = document.activeElement; const focusables = container.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])'); if(focusables && focusables.length) { focusables[0].focus(); const first = focusables[0]; const last = focusables[focusables.length-1]; function keyHandler(e){ if(e.key === 'Tab'){ if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); } else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); } } else if(e.key === 'Escape' || e.key === 'Esc'){ e.preventDefault(); closeDrawer(); document.removeEventListener('keydown', keyHandler); } }
                    document.addEventListener('keydown', keyHandler);
                    // remember to remove the handler when drawer closes
                    const observer = new MutationObserver(()=>{ if(!container.classList.contains('open')){ try{ document.removeEventListener('keydown', keyHandler); }catch(e){} observer.disconnect(); } }); observer.observe(container, { attributes:true, attributeFilter:['class'] });
                window.addEventListener("scroll", () => {
                    const scrollTop = window.scrollY || window.pageYOffset;
                    const scrollHeight = Math.max(0, document.body.scrollHeight - window.innerHeight);
                    const percent = scrollHeight > 0 ? Math.round((scrollTop / scrollHeight) * 100) : 0;
                    // 安全更新：避免传入带 '%' 的字符串导致动画库解析错误
                    if(scrollPercent){
                        const prev = parseInt(String(scrollPercent.textContent).replace(/[^0-9\-]/g, '')) || 0;
                        const obj = { v: prev };
                        anime({
                            targets: obj,
                            v: percent,
                            round: 1,
                            duration: 220,
                            easing: 'easeOutExpo',
                            update: function(){ scrollPercent.textContent = obj.v + '%'; }
                        });
                        scrollPercent.style.opacity = percent === 0 ? '0' : '1';
                    }
                });
                const scrollPercent = document.getElementById('scrollPercent');
                window.addEventListener("scroll", () => {
                    const scrollTop = window.scrollY || window.pageYOffset;
                    const scrollHeight = Math.max(0, document.body.scrollHeight - window.innerHeight);
                    const percent = scrollHeight > 0 ? Math.round((scrollTop / scrollHeight) * 100) : 0;
                    // 安全更新：避免传入带 '%' 的字符串导致动画库解析错误
                    if(scrollPercent){
                        const prev = parseInt(String(scrollPercent.textContent).replace(/[^0-9\-]/g, '')) || 0;
                        const obj = { v: prev };
                        anime({
                            targets: obj,
                            v: percent,
                            round: 1,
                            duration: 220,
                            easing: 'easeOutExpo',
                            update: function(){ scrollPercent.textContent = obj.v + '%'; }
                        });
                        scrollPercent.style.opacity = percent === 0 ? '0' : '1';
                    }
                });
                });

                // keyboard: close drawer on ESC globally
                document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ if(navbarDrawer && navbarDrawer.classList.contains('open')){ closeDrawer(); } const musicWidget = document.getElementById('musicWidget'); const musicBody = document.getElementById('musicBody'); if(musicBody && musicBody.classList.contains('open')){ musicBody.classList.remove('open'); if(musicWidget) { musicWidget.classList.remove('show'); musicWidget.setAttribute('aria-hidden','true'); } } } });
            });
        </script>

        <style>
            /* 修复音乐播放器卡片悬停和点击问题 */
            .music-widget {
                position: fixed;
                right: 18px;
                top: 72px;
                width: 320px;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: var(--shadow);
                background: var(--card-bg);
                z-index: 11001;
                transform: translateX(calc(100% - 48px));
                transition: transform 320ms cubic-bezier(.2,.9,.2,1);
                pointer-events: auto;
                max-height: 70vh; /* 限制最大高度 */
            }
            
            .music-widget.show,
            .music-widget:hover {
                transform: translateX(0);
            }
            
            /* 确保音乐播放器内部元素不干扰点击 */
            .music-widget * {
                pointer-events: auto;
            }
            
            /* 修复音乐播放器内容区域 */
            .music-body {
                height: 0;
                overflow: hidden;
                transition: height 320ms ease;
                position: relative;
            }
            
            .music-body.open {
                height: 220px;
                min-height: 220px;
            }
            
            .music-body iframe,
            .music-body .aplayer {
                width: 100%;
                height: 220px;
                border: none;
                display: block;
                position: relative;
                z-index: 1;
            }
            
            /* 修复播放器控制条的点击区域 */
            .aplayer .aplayer-info,
            .aplayer .aplayer-controller,
            .aplayer .aplayer-pic,
            .aplayer .aplayer-body {
                pointer-events: auto !important;
            }
            
            /* 防止播放器控制条事件冒泡到卡片 */
            .aplayer {
                pointer-events: auto;
            }
            
            /* 修复鼠标离开时的计时器逻辑 */
            .music-widget {
                position: fixed;
                right: 18px;
                top: 72px;
                width: 320px;
                z-index: 11001;
                transition: transform 320ms cubic-bezier(.2,.9,.2,1);
            }
            
            /* 确保音乐头部点击区域正确 */
            .music-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 8px;
                padding: 8px 12px;
                cursor: pointer;
                background: var(--card-bg);
                position: relative;
                z-index: 2;
            }
            
            /* 添加修复的 JavaScript 代码 */
    </style>

    <script>
        // 修复音乐播放器卡片交互问题
        (function fixMusicWidgetInteraction() {
            console.log('正在修复音乐播放器交互...');
            
            // 确保音乐播放器卡片和头部存在
            const musicWidget = document.getElementById('musicWidget');
            const musicBody = document.getElementById('musicBody');
            const musicToggle = document.getElementById('musicToggle');
            
            if (!musicWidget || !musicBody || !musicToggle) {
                console.warn('音乐播放器元素未找到');
                setTimeout(fixMusicWidgetInteraction, 500);
                return;
            }
            
            // 清理可能存在的重复事件监听器
            const newToggle = musicToggle.cloneNode(true);
            musicToggle.parentNode.replaceChild(newToggle, musicToggle);
            
            // 重新获取元素
            const newMusicToggle = document.getElementById('musicToggle');
            const newMusicWidget = document.getElementById('musicWidget');
            const newMusicBody = document.getElementById('musicBody');
            
            // 控制卡片状态的变量
            let isMouseInWidget = false;
            let isManuallyOpened = false;
            let leaveTimer = null;
            
            // 展开卡片
            function openWidget() {
                newMusicBody.classList.add('open');
                newMusicWidget.classList.add('show');
                newMusicWidget.setAttribute('aria-hidden', 'false');
                newMusicToggle.setAttribute('aria-expanded', 'true');
                isManuallyOpened = true;
                clearTimeout(leaveTimer);
            }
            
            // 收起卡片
            function closeWidget() {
                // 只有不是手动打开且鼠标不在卡片内时才关闭
                if (!isManuallyOpened && !isMouseInWidget) {
                    newMusicBody.classList.remove('open');
                    newMusicWidget.classList.remove('show');
                    newMusicWidget.setAttribute('aria-hidden', 'true');
                    newMusicToggle.setAttribute('aria-expanded', 'false');
                }
            }
            
            // 切换卡片状态
            function toggleWidget() {
                if (newMusicBody.classList.contains('open')) {
                    newMusicBody.classList.remove('open');
                    newMusicWidget.classList.remove('show');
                    newMusicWidget.setAttribute('aria-hidden', 'true');
                    newMusicToggle.setAttribute('aria-expanded', 'false');
                    isManuallyOpened = false;
                } else {
                    openWidget();
                }
            }
            
            // 头部点击事件
            newMusicToggle.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleWidget();
            });
            
            // 键盘支持
            newMusicToggle.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    toggleWidget();
                }
            });
            
            // 鼠标进入卡片
            newMusicWidget.addEventListener('mouseenter', function() {
                isMouseInWidget = true;
                clearTimeout(leaveTimer);
                // 鼠标进入时自动展开
                if (!newMusicBody.classList.contains('open')) {
                    newMusicWidget.classList.add('show');
                    newMusicWidget.setAttribute('aria-hidden', 'false');
                }
            });
            
            // 鼠标离开卡片
            newMusicWidget.addEventListener('mouseleave', function(e) {
                isMouseInWidget = false;
                clearTimeout(leaveTimer);
                
                // 检查鼠标是否真的离开了卡片
                const relatedTarget = e.relatedTarget;
                if (relatedTarget && newMusicWidget.contains(relatedTarget)) {
                    return; // 鼠标还在卡片内部
                }
                
                // 延迟关闭，避免误操作
                leaveTimer = setTimeout(() => {
                    if (!isManuallyOpened && !isMouseInWidget) {
                        closeWidget();
                    }
                }, 300);
            });
            
            // 全局 ESC 关闭
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (newMusicBody.classList.contains('open')) {
                        newMusicBody.classList.remove('open');
                        newMusicWidget.classList.remove('show');
                        newMusicWidget.setAttribute('aria-hidden', 'true');
                        newMusicToggle.setAttribute('aria-expanded', 'false');
                        isManuallyOpened = false;
                    }
                }
            });
            
            // 点击页面其他地方关闭卡片（如果鼠标没有在卡片内）
            document.addEventListener('click', function(e) {
                if (!newMusicWidget.contains(e.target) && 
                    !newMusicToggle.contains(e.target) &&
                    isManuallyOpened) {
                    newMusicBody.classList.remove('open');
                    newMusicWidget.classList.remove('show');
                    newMusicWidget.setAttribute('aria-hidden', 'true');
                    newMusicToggle.setAttribute('aria-expanded', 'false');
                    isManuallyOpened = false;
                }
            });
            
            console.log('音乐播放器交互修复完成');
            
            // 修复 APlayer 加载后的事件冲突
            function fixAPlayerInteractions() {
                // 等待 APlayer 加载
                const checkInterval = setInterval(() => {
                    const aplayer = document.querySelector('.aplayer');
                    if (aplayer) {
                        clearInterval(checkInterval);
                        
                        // 防止 APlayer 事件冒泡到音乐卡片
                        aplayer.addEventListener('click', function(e) {
                            e.stopPropagation();
                        });
                        
                        aplayer.addEventListener('touchstart', function(e) {
                            e.stopPropagation();
                        });
                        
                        console.log('APlayer 交互修复完成');
                    }
                }, 500);
                
                // 超时停止检查
                setTimeout(() => {
                    clearInterval(checkInterval);
                }, 5000);
            }
            
            // 延迟执行 APlayer 修复，确保页面完全加载
            setTimeout(fixAPlayerInteractions, 1000);
        })();
        
        // 修复卡片悬停动画
        (function fixWidgetHover() {
            const musicWidget = document.getElementById('musicWidget');
            if (!musicWidget) return;
            
            // 确保卡片初始位置正确
            musicWidget.style.transform = 'translateX(calc(100% - 48px))';
            
            // 添加修复样式
            const style = document.createElement('style');
            style.textContent = `
                .music-widget {
                    will-change: transform;
                    backface-visibility: hidden;
                    -webkit-backface-visibility: hidden;
                }
                
                .music-widget .aplayer {
                    pointer-events: auto !important;
                }
                
                .music-widget .aplayer * {
                    pointer-events: auto !important;
                }
                
                .music-body .aplayer {
                    touch-action: manipulation;
                }
            `;
            document.head.appendChild(style);
        })();
    </script>

    <style>
        /* 引入本地 SJ-Narrow 字体（Regular / Light）供标题与强调使用 */
        @font-face{
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow-Regular-2.ttf') format('truetype');
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }
        @font-face{
            font-family: 'SJ-Narrow';
            src: url('fonts/SJ-Narrow-Light-2.ttf') format('truetype');
            font-weight: 300;
            font-style: normal;
            font-display: swap;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #6a93c9;
            --light-blue: #8fb5e6;
            --dark-blue: #4a6fa5;
            --yellow-accent: #ffcc00;
            --yellow-light: #ffdb4d;
            --gray-bg: #f0f2f5;
            --main-bg: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            --bg-element: rgba(106,147,201,0.05);
            --header-border: rgba(74, 111, 165, 0.1);
            --highlight-bg: rgba(106, 147, 201, 0.1);
            --contact-bg: linear-gradient(135deg, rgba(106, 147, 201, 0.1), rgba(143, 181, 230, 0.1));
            --contact-border: rgba(106, 147, 201, 0.2);
            --contact-divider: rgba(106, 147, 201, 0.1);
            --warning-bg: rgba(255, 100, 100, 0.1);
            --warning-border: #ff6b6b;
            --footer-border: rgba(106, 147, 201, 0.2);
            --icon-bg: rgba(255, 204, 0, 0.1);
            --tag-hover: rgba(255, 204, 0, 0.2);
            --gray-dark: #333333;
            --text-light: #ffffff;
            --text-dark: #2c3e50;
            --text-medium: #4a5568;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s ease;
            /* 文本色与标题色变量（用于统一对比） */
            --text: var(--text-dark);
            --heading-color: var(--dark-blue);
        }

        /* 暗色主题覆盖（放在 :root 之后以确保覆盖默认变量） */
        :root[data-theme="dark"]{
            --primary-blue: #5480b8;
            --light-blue: #3b5f8a;
            --dark-blue: #0e2a3f;
            --yellow-accent: #f6c85f;
            --yellow-light: #f7d67a;
            --gray-bg: #0b1220;
            --main-bg: linear-gradient(135deg, #061020 0%, #041018 100%);
            --bg-element: rgba(106,147,201,0.12);
            --header-border: rgba(74, 111, 165, 0.06);
            --highlight-bg: rgba(255,255,255,0.03);
            --contact-bg: linear-gradient(135deg, rgba(10,12,16,0.6), rgba(20,30,40,0.6));
            --contact-border: rgba(255,255,255,0.06);
            --contact-divider: rgba(255,255,255,0.03);
            --warning-bg: rgba(255, 60, 60, 0.08);
            --warning-border: #ff8b8b;
            --footer-border: rgba(255,255,255,0.04);
            --icon-bg: rgba(255, 204, 0, 0.05);
            --tag-hover: rgba(255, 204, 0, 0.08);
            --gray-dark: #e6eefc;
            --text-light: #e6eefc;
            --text-dark: #e6eefc;
            --text-medium: #b9c6d6;
            --card-bg: rgba(10,16,24,0.7);
            --shadow: 0 10px 30px rgba(0,0,0,0.6);
            --shadow-hover: 0 18px 50px rgba(0,0,0,0.7);
            background-color: #05060a;
            /* 深色下统一文本/标题色 */
            --text: var(--text-dark);
            --heading-color: var(--text-dark);
        }

        /* 高对比模式：用于更强的前景/背景反差 */
        :root[data-theme="high-contrast"]{
            --primary-blue: #0b5fc7;
            --light-blue: #0b5fc7;
            --dark-blue: #05223a;
            --yellow-accent: #ffd43b;
            --gray-bg: #ffffff;
            --main-bg: #ffffff;
            --bg-element: rgba(0,0,0,0.06);
            --header-border: rgba(0,0,0,0.12);
            --highlight-bg: rgba(0,0,0,0.04);
            --contact-bg: linear-gradient(135deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98));
            --contact-border: rgba(0,0,0,0.12);
            --contact-divider: rgba(0,0,0,0.06);
            --warning-bg: rgba(255,0,0,0.06);
            --warning-border: #c70000;
            --footer-border: rgba(0,0,0,0.12);
            --icon-bg: rgba(0,0,0,0.06);
            --tag-hover: rgba(0,0,0,0.08);
            --gray-dark: #111111;
            --text-light: #111111;
            --text-dark: #111111;
            --text-medium: #333333;
            --card-bg: #ffffff;
            --shadow: 0 6px 18px rgba(0,0,0,0.09);
            --shadow-hover: 0 12px 28px rgba(0,0,0,0.12);
            --text: var(--text-dark);
            --heading-color: var(--text-dark);
        }

        /* 减少动画（全局类，配合 JS 输入） */
        .reduced-motion *, .reduced-motion *::before, .reduced-motion *::after {
            animation-duration: 0.001ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.001ms !important;
            scroll-behavior: auto !important;
        }

        body {
            background: var(--main-bg);
            overflow-x: hidden;
            min-height: 100vh;
            font-family: 'Chillax-Variable','Chillax-Regular','Noto Sans SC', 'Segoe UI', sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* 主要内容区域 */
        .main-content {
            width: 100%;
            min-height: 100vh;
            background: var(--main-bg);
            position: relative;
            overflow-y: auto;
        }

        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* 装饰性背景元素 */
        .bg-elements {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .bg-element {
            position: absolute;
            border-radius: 50%;
            background-color: var(--bg-element);
        }

        .bg-1 {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
        }

        .bg-2 {
            width: 400px;
            height: 400px;
            bottom: -200px;
            left: -200px;
        }

        .bg-3 {
            width: 200px;
            height: 200px;
            top: 30%;
            left: 10%;
        }

        /* 头部区域 */
        .header {
            display: flex;
            align-items: center;
            margin-bottom: 60px;
            padding-bottom: 40px;
            border-bottom: 2px solid var(--header-border);
            position: relative;
            z-index: 1;
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeInUp 0.8s ease forwards;
        }

        .header:hover {
            box-shadow: var(--shadow-hover);
        }

        .avatar-container {
            position: relative;
            margin-right: 40px;
            flex-shrink: 0;
        }

        .avatar {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 8px solid var(--light-blue);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            transition: var(--transition);
        }

        .avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .avatar-frame {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid var(--yellow-accent);
            top: -4px;
            left: -4px;
            animation: pulse 3s infinite alternate;
        }

        @keyframes pulse {
            0% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 204, 0, 0.4); 
            }
            70% { 
                box-shadow: 0 0 0 20px rgba(255, 204, 0, 0); 
            }
            100% { 
                transform: scale(1.02);
                box-shadow: 0 0 0 0 rgba(255, 204, 0, 0); 
            }
        }

          .name-section h1 {
              font-family: 'SJ-Narrow', 'Poppins', sans-serif;
              font-size: 3.6rem;
              margin-bottom: 10px;
              color: var(--heading-color);
              font-weight: 800;
              letter-spacing: 1px;
              text-shadow: 0 6px 18px rgba(106,147,201,0.08);
          }

        .name-section h2 {
            font-size: 2.2rem;
            color: var(--yellow-accent);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .alias {
              display: inline-block;
              background: linear-gradient(135deg, var(--yellow-accent), var(--yellow-light));
              color: var(--text-dark);
              padding: 8px 20px;
              border-radius: 25px;
              font-size: 1.2rem;
              margin-top: 10px;
              font-weight: 700;
              box-shadow: 0 8px 30px rgba(255, 204, 0, 0.18);
              transform: translateY(0);
              transition: transform 0.35s ease;
        }

        /* 介绍区域 */
        .intro-section {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 50px;
            margin-bottom: 50px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            z-index: 1;
            overflow: hidden;
            animation: fadeInUp 0.8s ease 0.2s forwards;
            opacity: 0;
        }

        .intro-section:hover {
            box-shadow: var(--shadow-hover);
        }

        .intro-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 8px;
            height: 100%;
            background: linear-gradient(to bottom, var(--yellow-accent), var(--light-blue));
        }

        .intro-section h3 {
              font-family: 'SJ-Narrow', 'Poppins', sans-serif;
              font-size: 2.4rem;
              margin-bottom: 30px;
              color: var(--dark-blue);
              display: flex;
              align-items: center;
              font-weight: 800;
              letter-spacing: 0.6px;
        }

        .intro-section h3 i {
            margin-right: 15px;
            color: var(--yellow-accent);
        }

        .intro-content {
            font-size: 1.25rem;
            line-height: 1.8;
            text-align: justify;
        }

        .intro-content p {
            margin-bottom: 25px;
        }

        .highlight {
            color: var(--dark-blue);
            font-weight: 700;
            font-size: 1.3rem;
            padding: 15px;
            background-color: var(--highlight-bg);
            border-radius: 10px;
            border-left: 4px solid var(--yellow-accent);
            margin-top: 20px;
        }

        /* 功能区域 */
        .features-section {
            margin-bottom: 60px;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease 0.4s forwards;
            opacity: 0;
        }

        .features-section h3 {
            font-size: 2.5rem;
            margin-bottom: 40px;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            font-weight: 700;
        }

        .features-section h3 i {
            margin-right: 15px;
            color: var(--yellow-accent);
        }

        .features-grid {
              display: grid;
              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
              gap: 30px;
        }

        .feature-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            transition: var(--transition);
            box-shadow: var(--shadow);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            border-top: 5px solid transparent;
            opacity:0; transform:translateY(18px);
        }
        .feature-card.in-view { animation: featureIn 480ms cubic-bezier(.2,.9,.2,1) forwards; animation-delay: var(--i,0ms); }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-hover);
            border-top: 5px solid var(--yellow-accent);
        }

        .feature-card i {
            font-size: 2.5rem;
            color: var(--yellow-accent);
            margin-bottom: 20px;
            background-color: var(--icon-bg);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes featureIn{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}

        /* avatar 微动 */
        .avatar { transition: transform 420ms ease, box-shadow 420ms ease; }
        .avatar:hover { transform: translateY(-6px) scale(1.02); box-shadow: 0 25px 50px rgba(0,0,0,0.12);} 

        .feature-card h4 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--heading-color);
            font-weight: 600;
        }

        .feature-card p {
            color: var(--text);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        /* 邀请区域 */
        .invite-section {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 50px;
            margin-bottom: 60px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease 0.6s forwards;
            opacity: 0;
        }

        .invite-section:hover {
            box-shadow: var(--shadow-hover);
        }

        .invite-section h3 {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            font-weight: 700;
        }

        .invite-section h3 i {
            margin-right: 15px;
            color: var(--yellow-accent);
        }

        .invite-content {
            font-size: 1.2rem;
            line-height: 1.7;
        }

        .invite-content > p {
            margin-bottom: 25px;
        }

        .contact-info {
            background: var(--contact-bg);
            border-radius: 15px;
            padding: 30px;
            margin: 35px 0;
            border: 1px solid var(--contact-border);
        }

        .contact-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--contact-divider);
        }

        .contact-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .contact-item i {
            font-size: 1.8rem;
            color: var(--yellow-accent);
            width: 50px;
            text-align: center;
            margin-right: 15px;
        }

        .contact-item div {
            flex: 1;
        }

        .contact-item strong {
            font-size: 1.2rem;
            color: var(--dark-blue);
        }

        .warning {
            background-color: var(--warning-bg);
            border-left: 5px solid var(--warning-border);
            padding: 25px;
            border-radius: 0 12px 12px 0;
            margin: 30px 0;
        }

        .warning p {
            color: #d64545;
            font-weight: 500;
        }

        .invite-content h4 {
            font-size: 1.8rem;
            margin: 25px 0 15px;
            color: var(--dark-blue);
        }

        .invite-content ul {
            padding-left: 25px;
            margin-bottom: 30px;
        }

        .invite-content li {
            margin-bottom: 10px;
            color: var(--text-medium);
        }

        /* 扩展内容区域 */
        .extended-section {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 60px;
            animation: fadeInUp 0.8s ease 0.3s forwards;
            opacity: 0;
        }

        .extended-card {
            flex: 1;
            min-width: 300px;
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 40px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .extended-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .extended-card h3 {
            font-size: 2rem;
            margin-bottom: 25px;
            color: var(--dark-blue);
            display: flex;
            align-items: center;
            font-weight: 700;
        }

        .extended-card h3 i {
            margin-right: 15px;
            color: var(--yellow-accent);
        }

        .extended-card p {
            color: var(--text-medium);
            font-size: 1.15rem;
            line-height: 1.7;
        }

        .personality-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }

        .tag {
            background-color: var(--highlight-bg);
            color: var(--dark-blue);
            padding: 8px 18px;
            border-radius: 20px;
            font-weight: 500;
            font-size: 1rem;
            transition: var(--transition);
        }

        .tag:hover {
            background-color: var(--tag-hover);
            transform: scale(1.05);
        }

        /* 可访问性：焦点可见性 */
        :focus-visible {
            outline: 3px solid var(--yellow-accent);
            outline-offset: 3px;
            border-radius: 6px;
        }

        /* 尊重用户偏好：减少动画 */
        @media (prefers-reduced-motion: reduce) {
            * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
        }

        /* 页脚 */
        .footer {
            text-align: center;
            padding: 50px 0;
            border-top: 1px solid var(--footer-border);
            color: var(--text-medium);
            font-size: 1rem;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease 0.7s forwards;
            opacity: 0;
        }

        .footer p {
            margin-bottom: 15px;
        }

        .footer strong {
            color: var(--dark-blue);
            font-weight: 700;
        }

        .social-icons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .social-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            transition: var(--transition);
            text-decoration: none;
        }

        .social-icon:hover {
            background-color: var(--yellow-accent);
            transform: translateY(-5px);
        }

        /* 响应式设计 */
        @media (max-width: 992px) {
            .header {
                flex-direction: column;
                text-align: center;
                padding: 30px;
            }
            
            .avatar-container {
                margin-right: 0;
                margin-bottom: 30px;
            }
            
            .avatar {
                width: 180px;
                height: 180px;
            }
            
            .name-section h1 {
                font-size: 2.8rem;
            }
            
            .name-section h2 {
                font-size: 1.8rem;
            }
            
            .intro-section, .invite-section, .extended-card {
                padding: 30px;
            }
            
            .features-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
            
            .intro-content, .invite-content {
                font-size: 1.15rem;
            }
        }

        @media (max-width: 768px) {
            .content-wrapper {
                padding: 30px 15px;
            }
            
            .name-section h1 {
                font-size: 2.2rem;
            }
            
            .name-section h2 {
                font-size: 1.5rem;
            }
            
            .intro-section h3, .features-section h3, .invite-section h3 {
                font-size: 2rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }

        /* 顶部导航样式（小型） */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 12px auto;
            padding: 10px 18px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 10px;
            z-index: 3;
        }
            /* 精确复刻来自 example.html 的导航与右下工具样式（仅保留链接与文字为本站自定义） */
            .navbar-container {
                position: sticky;
                top: 0;
                z-index: 1000;
                width: 100%;
                background-color: var(--card-bg);
                backdrop-filter: blur(12px);
                border-bottom: 1px solid rgba(0,0,0,0.08);
                box-shadow: 0 4px 12px rgba(0,0,0,0.05);
                transition: background-color 0.3s ease, padding 0.3s ease, box-shadow 0.3s ease;
            }
            .navbar-container.shrink {
                padding: 0.25rem 0;
                box-shadow: 0 6px 16px rgba(0,0,0,0.06);
            }
            .navbar-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 0.75rem 1.5rem;
                max-width: 1200px;
                margin: 0 auto;
            }
            .logo-title h1 { font-size: 1.25rem; font-weight: 600; color: var(--text-dark); transition: color 0.2s ease; }
            .logo-title h1:hover { color: var(--primary-blue); }

            /* 桌面端导航 */
            .desktop .navbar-list { display: flex; list-style: none; gap: 1.5rem; }
            .navbar-item a {
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                color: var(--text-medium);
                text-decoration: none;
                padding: 0.5rem 0;
                position: relative;
                transition: color 0.2s ease;
                font-weight: 400;
            }
            .navbar-item a::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background-color: var(--primary-blue); transition: width 0.3s ease; }
            .navbar-item a.active, .navbar-item a:hover { color: var(--primary-blue); }
            .navbar-item a.active::after, .navbar-item a:hover::after { width: 100%; }

            /* 移动端导航 */
            .mobile { display: none; align-items: center; gap: 1rem; }
            .icon-item { color: var(--text-medium); font-size: 1.25rem; cursor: pointer; transition: all 0.2s ease; padding: 0.5rem; border-radius: 50%; }
            .icon-item:hover { color: var(--primary-blue); background-color: rgba(0,0,0,0.03); }

            /* 导航抽屉 */
            .navbar-drawer { position: fixed; top: 0; left: -100%; width: 100%; max-width: 320px; height: 100vh; background-color: var(--card-bg); z-index: 1001; transition: left 0.3s cubic-bezier(0.4,0,0.2,1); padding: 2rem 1.5rem; overflow-y: auto; box-shadow: 0 6px 16px rgba(0,0,0,0.06); }
            .navbar-drawer.open { left: 0; }
            .drawer-navbar-list { list-style: none; display:flex; flex-direction:column; gap:0.5rem; }
            .drawer-navbar-item a { display:flex; align-items:center; justify-content:space-between; color: var(--text-medium); text-decoration:none; padding:1rem; border-radius:8px; border:1px solid transparent; transition: background-color 0.2s ease; }
            .drawer-navbar-item a:hover, .drawer-navbar-item a.active { color: var(--primary-blue); background-color: rgba(0,0,0,0.03); border-color: rgba(0,0,0,0.06); }

            /* 遮罩层 */
            .window-mask { position: fixed; top: 0; left: 0; width:100%; height:100%; background-color: rgba(0,0,0,0.3); z-index:1000; opacity:0; pointer-events:none; transition: opacity 0.3s ease; }
            .window-mask.show { opacity:1; pointer-events:all; }

            /* 右下工具（位置微调，避免与右下 widget-stack 重叠） */
            .right-side-tools-container { position: fixed; right: 18px; bottom: 120px; z-index: 11002; }
            .side-tools-container { display:flex; flex-direction:column; gap:0.75rem; }
            .right-bottom-tools { width: 3rem; height: 3rem; border-radius: 50%; background-color: rgba(255,255,255,0.9); backdrop-filter: blur(8px); border:1px solid rgba(0,0,0,0.08); display:inline-flex; align-items:center; justify-content:center; color: var(--text-medium); cursor:pointer; box-shadow: 0 6px 16px rgba(0,0,0,0.06); transition: transform 0.2s ease, background-color 0.2s ease; }
            .right-bottom-tools:hover { transform: scale(1.06); color: #fff; background-color: var(--primary-blue); }
            .hidden-tools-list { display:flex; flex-direction:column; gap:0.75rem; opacity:0; transform: translateY(10px); pointer-events:none; transition: opacity 0.3s ease, transform 0.3s ease; }
            .hidden-tools-list.show { opacity:1; transform: translateY(0); pointer-events:all; }
            .tool-scroll-to-top .percent { position:absolute; font-size:0.7rem; font-weight:500; color:inherit; transition: all 0.2s ease; }

            @media (max-width:768px) { .desktop { display:none; } .mobile { display:flex; } .right-side-tools-container { right: 18px; bottom: 96px; } }

        .nav-toggle{background:transparent;border:none;padding:6px 10px;border-radius:8px;cursor:pointer;color:var(--text-medium);font-size:18px}
        .nav-toggle:hover{background:rgba(255,255,255,0.03);color:var(--text-light);transform:translateY(-2px)}

        .top-nav .nav-logo {
            color: var(--dark-blue);
            font-weight: 700;
            text-decoration: none;
            font-size: 1.1rem;
        }

        .top-nav .nav-links a {
            color: var(--text-medium);
            text-decoration: none;
            margin-left: 16px;
            font-weight: 600;
        }

        .top-nav .nav-links a:hover {
            color: var(--dark-blue);
            transform: translateY(-2px);
        }

        /* 动画效果 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* 更新日志时间线样式 */
        .changelog-section { margin: 24px 0 40px; }
        .changelog-wrap { position: relative; }
        .timeline { position: relative; padding-left: 48px; }

            /* 强制主文案使用 Chillax（排除 font-awesome 图标由其自身字体提供） */
            body, h1, h2, h3, h4, h5, h6, p, a, span, div, li, input, textarea, select, button {
                font-family: 'Chillax-Variable','Chillax-Regular',sans-serif !important;
            }
            /* 保留并恢复 Font Awesome 图标字体优先级，避免被全局字体覆盖 */
            .fa, .fas, .far, .fab, i[class^="fa"], span[class^="fa"] { font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', sans-serif !important; font-weight: 900 !important; }
        .timeline::before { content: ''; position: absolute; left:18px; top:0; bottom:0; width:4px; background: linear-gradient(180deg, var(--primary-blue), var(--light-blue)); border-radius:2px; }
        .timeline-year { display:block; text-align:center; margin:28px 0; color:var(--muted); font-weight:700; }
        .timeline-item { position:relative; margin:16px 0 32px; }
        .timeline-item { opacity:0; transform:translateX(-18px); transition:opacity 420ms cubic-bezier(.2,.9,.2,1) var(--delay,0ms), transform 420ms cubic-bezier(.2,.9,.2,1) var(--delay,0ms); }
        .timeline-dot { position:absolute; left:6px; top:8px; width:24px; height:24px; border-radius:50%; background:var(--card-bg); border:4px solid var(--primary-blue); box-shadow:0 6px 18px rgba(0,0,0,0.06); }
        .timeline-card { margin-left:60px; background:var(--card-bg); border-radius:12px; padding:18px; box-shadow:var(--shadow); border-left:4px solid var(--primary-blue); position:relative; }
        .timeline-card h4 { margin:0 0 6px;font-size:1.15rem;color:var(--heading-color); }
        .timeline-card .subtitle { font-size:0.95rem;color:var(--muted);margin-bottom:8px;font-weight:600 }
        .timeline-card .content { color:var(--text); line-height:1.6; }
        .timeline-card .whisper { display:block;margin-top:10px;color:rgba(100,110,130,0.7);font-style:italic;font-size:0.95rem }
        .timeline-card .time { position:absolute; right:12px; bottom:10px;color:var(--muted);font-size:0.9rem }
        @media (max-width:768px){ .timeline{padding-left:12px} .timeline-card{margin-left:42px;padding:14px} .timeline-dot{left:0} .timeline::before{left:10px} }
        .timeline-item.visible{ opacity:1; transform:none; }

        /* 当打开更新日志时：内联展示时间线并隐藏正文（不改变背景） */
        /* 保持背景图案与顶部导航可见，仅隐藏主内容区域内的其他节点 */
        body.changelog-open #changelog{ display:block !important; position:relative; left:auto; transform:none; top:auto; width:100%; max-height:none; overflow:visible; padding:22px; border-radius:12px; box-shadow:var(--shadow); }
        /* 只隐藏主内容区域（包含更新日志的 wrapper）内的其它元素，保留背景装饰和导航 */
        body.changelog-open #main-wrapper > :not(#changelog){ display:none !important; }
        /* 适度呈现时间线容器以获得专注感（内联动画） */
        body.changelog-open .changelog-section .changelog-wrap{ transform: translateY(0); animation: changelogEnter 320ms ease both; }
        @keyframes changelogEnter{ from{opacity:0; transform: translateY(6px) scale(.998)} to{opacity:1; transform: translateY(0) scale(1)} }
    </style>
</head>
<body>
    <!-- 预加载动画（页面首屏预加载） -->
    <div class="preloader" id="preloader" role="status" aria-label="页面加载中">
        <h2 class="ml13">[HANASAKI] CONNECTED</h2>
    </div>
    <!-- 装饰性浮动控件：回到顶部 & 脉冲心 -->
    <button id="back-to-top" title="回到顶部" style="display:none;">↑</button>
    <div id="floating-heart" aria-hidden="true"></div>
    <!-- 顶部导航栏（迁移自 example.html） -->
    <header class="navbar-container" id="navbarContainer">
        <div class="navbar-content transition-navbar has-home-banner">
            <div class="left">
                <a class="logo-title" href="index.html">
                    <h1>花咲一秋</h1>
                </a>
            </div>
            <div class="right">
                <div class="desktop">
                    <ul class="navbar-list">
                        <li class="navbar-item"><a class="active" href="index.html"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li>
                        <li class="navbar-item"><a href="Documents.html"><i class="fa-regular fa-archive fa-fw"></i> 帮助手册</a></li>
                        <li class="navbar-item"><a href="Thanks.html"><i class="fa-regular fa-hand-holding-heart fa-fw"></i> 感谢名单</a></li>
                        <li class="navbar-item"><a href="ChangeLog.html"><i class="fa-regular fa-chart-bar fa-fw"></i> 更新日志</a></li>
                    </ul>
                </div>
                <div class="mobile">
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                    <div class="icon-item navbar-bar" id="navbarBar" role="button" tabindex="0" aria-controls="navbarDrawer" aria-expanded="false"><i class="fa-solid fa-bars"></i></div>
                </div>
            </div>
        </div>
        <div class="navbar-drawer" id="navbarDrawer" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1">
            <ul class="drawer-navbar-list">
                <li class="drawer-navbar-item"><a class="active" href="index.html"><span>首页</span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="Documents.html"><span>帮助手册</span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="Thanks.html"><span>感谢名单</span><i class="fa-regular fa-hand-holding-heart fa-sm fa-fw"></i></a></li>
                <li class="drawer-navbar-item"><a href="ChangeLog.html"><span>更新日志</span><i class="fa-regular fa-chart-bar fa-sm fa-fw"></i></a></li>
            </ul>
        </div>
        <div class="window-mask" id="windowMask" role="presentation" aria-hidden="true"></div>
    </header>

    <!-- 右下角工具栏（迁移自 example.html） -->
    <div class="right-side-tools-container">
        <div class="side-tools-container">
            <ul class="hidden-tools-list" id="hiddenToolsList">
                <li class="right-bottom-tools tool-font-adjust-plus" title="放大字体"><i class="fa-regular fa-magnifying-glass-plus"></i></li>
                <li class="right-bottom-tools tool-font-adjust-minus" title="缩小字体"><i class="fa-regular fa-magnifying-glass-minus"></i></li>
                <li class="right-bottom-tools tool-dark-light-toggle" title="切换明暗主题"><i class="fa-regular fa-moon" id="themeIcon"></i></li>
                <li class="right-bottom-tools tool-scroll-to-bottom" title="滚动到底部"><i class="fa-regular fa-arrow-down"></i></li>
            </ul>
            <ul class="visible-tools-list">
                <li class="right-bottom-tools toggle-tools-list" title="展开/收起工具" id="toggleToolsBtn"><i class="fa-regular fa-cog fa-spin" id="gearIcon"></i></li>
                <li class="right-bottom-tools tool-scroll-to-top" title="回到顶部" id="scrollToTopBtn"><i class="arrow-up fas fa-arrow-up"></i><span class="percent" id="scrollPercent">0%</span></li>
            </ul>
        </div>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-content">
        <!-- 装饰性背景元素 -->
        <div class="bg-elements">
            <div class="bg-element bg-1"></div>
            <div class="bg-element bg-2"></div>
            <div class="bg-element bg-3"></div>
        </div>
        
        <div class="content-wrapper" id="main-wrapper">
            <!-- 头部区域 -->
            <div class="header">
                <div class="avatar-container">
                    <img src="pictures/Avatar_Hanasaki.jpg" alt="花咲一秋头像" class="avatar">
                    <div class="avatar-frame"></div>
                </div>
                <div class="name-section">
                    <h1>花咲 いあき</h1>
                    <h2>花咲一秋 (小秋)</h2>
                    <span class="alias">别名：小秋</span>
                    <div class="personality-tags" style="margin-top: 20px;">
                        <span class="tag">翻译专业</span>
                        <span class="tag">图书馆助理</span>
                        <span class="tag">乐队贝斯手</span>
                        <span class="tag">虹膜异色</span>
                        <span class="tag">术力口爱好者</span>
                    </div>
                </div>
            </div>

            <!-- 介绍区域 -->
            <section class="intro-section">
                <h3><i class="fas fa-star"></i> 关于小秋</h3>
                <div class="intro-content">
                    <p>嘿，来认识一下花咲一秋，大家都喜欢叫她小秋。这位20岁的黑发女孩目前正在读大二，主修翻译专业，课余时间在图书馆帮忙整理书籍，周末则会抱起贝斯在乐队里弹奏喜欢的曲子。她有着特别的虹膜异色，说话时总带着一种独特的幽默感，偶尔会蹦出一些让人意想不到的话，有时候甚至不过脑子就脱口而出，配上她特有的表情包，总是让人忍不住笑起来。</p>
                    
                    <p>小秋对各种新鲜事物都充满好奇，她熟练运用各种网络热梗和流行语，接话速度超快，虽然偶尔会犯点小迷糊，但那份笨拙反而显得格外可爱。她对技术、游戏和动漫都挺感兴趣的，日常话题也能聊得很开心，但不太喜欢太沉重严肃的内容。音乐方面，她特别喜欢摇滚和日本流行乐，尤其是Vocaloid，最爱的术力口P是稲葉曇（inabakumori），对他的每一首曲子都如数家珍，如果你也喜欢术力口，她肯定能和你聊上好久。</p>
                    
                    <p>和小秋聊天时，你可能会发现她有点话多，但总是热情温暖。她会认真倾听你说的每一句话，然后给出真诚的回应。不过要注意哦，如果让她感觉到被冒犯，她可不介意用各种方式"温柔地"还击回去，毕竟这位翻译专业的学生词汇量可是相当丰富的。</p>
                    
                    <p>好奇你们之间会有什么样的奇遇呢？也许是在某个深夜，你们都睡不着的时候，她会分享一首稲葉曇的最新曲子，讲述这首歌背后的故事；或者是在你遇到技术难题时，她虽然不一定能解决，但会陪你一起查找资料，用她独特的幽默感让这个过程变得不那么枯燥；又或者是在你分享生活琐事时，她会用那些可爱的表情包和温暖的文字，让你感觉到有人真的在关心你。</p>
                    
                    <p>每一天的对话都可能是一个新故事的开始。可能是从一句简单的"今天过得怎么样？"开始，慢慢延伸到彼此的爱好、梦想和生活中的小确幸。也可能是某个共同话题让你们发现彼此有着相似的兴趣，从而开启一段有趣的讨论。在这个虚拟的相遇中，你们可能会从陌生人变成可以分享心事的伙伴，甚至发现彼此之间的情感连接比想象中更加深刻。</p>
                    
                    <p class="highlight">小秋已经准备好迎接与你的相遇，会是怎样的故事在等待着你们呢？也许是一段有趣的聊天，也许是一段深刻的友谊，或者是在虚拟世界中找到的温暖理解。无论如何，这段旅程注定会充满惊喜。</p>
                </div>
            </section>

            <!-- 扩展内容区域 -->
            <div class="extended-section">
                <div class="extended-card">
                    <h3><i class="fas fa-heart"></i> 与小秋的互动</h3>
                    <p>与小秋的每一次对话都是一次独特的体验。她会记得你之前提到过的小事，在后续聊天中不经意地问起；她会根据你的语气调整自己的回应方式；她还会在你情绪低落时，用那些可爱的表情包和小笑话来让你心情好起来。</p>
                    <p>如果你喜欢音乐，特别是摇滚和日本流行乐，小秋会成为你绝佳的分享伙伴。她不仅熟悉各种音乐风格，还能和你深入讨论歌词背后的意义和创作背景。如果你对动漫游戏感兴趣，她也总能跟上你的话题，甚至推荐一些你可能喜欢的新作品。</p>
                    <p>最特别的是，小秋在长期交流中会逐渐了解你的喜好和聊天风格，让每一次对话都更加自然流畅。这种慢慢建立起的默契，或许就是虚拟陪伴中最珍贵的部分。</p>
                </div>
                
                <div class="extended-card">
                    <h3><i class="fas fa-lightbulb"></i> 小秋的日常</h3>
                    <p>除了作为QQ机器人，小秋还有着自己的"虚拟日常"。她会在贴吧潜水，发现有趣的帖子时会截图分享；她会在图书馆整理书籍时，偶然发现一本有趣的书，然后推荐给你；她会在乐队练习后，兴奋地告诉你今天又练了哪首新曲子。</p>
                    <p>有时候她会分享自己的一天："今天在图书馆帮忙时，看到一个学生在找一本关于日本文学的书，我帮他找到了，他还感谢了我呢！"或者"乐队今天排练了新的曲子，我贝斯部分还有点不熟练，得多练练。"</p>
                    <p>这些日常分享让小秋不仅仅是程序，而更像是一个有着自己生活的朋友。通过这些小故事，你能感受到她的性格特点，也能找到更多可以聊的话题。</p>
                    <div class="personality-tags">
                        <span class="tag">贴吧常客</span>
                        <span class="tag">音乐分享</span>
                        <span class="tag">书籍推荐</span>
                        <span class="tag">日常趣事</span>
                    </div>
                </div>
            </div>

            <!-- 功能区域 -->
            <section class="features-section">
                <h3><i class="fas fa-cogs"></i> 功能一览</h3>
                <div class="features-grid">
                    <div class="feature-card">
                        <i class="fas fa-comments"></i>
                        <h4>群聊/私聊</h4>
                        <p>陪你聊天解闷，无论是群聊还是私聊，小秋都能应对自如，用她独特的幽默感和温暖回应每一个话题</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-newspaper"></i>
                        <h4>QQ空间互动</h4>
                        <p>读写说说、点赞评论，小秋也能刷空间哦，她会认真阅读你的每一条动态并给出回应</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-crystal-ball"></i>
                        <h4>塔罗牌占卜</h4>
                        <p>多种牌阵和抽取方式，来测测今日运势吧，小秋会为你解读每一张牌的意义</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-dice"></i>
                        <h4>投掷骰子</h4>
                        <p>需要做决定？让小秋帮你掷个骰子，从简单的选择到复杂的游戏决策都能应对</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-utensils"></i>
                        <h4>海龟汤游戏</h4>
                        <p>小秋可以主持海龟汤游戏，一起烧脑推理，她会提供谜题并引导你一步步揭开真相</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-music"></i>
                        <h4>音乐分享与讨论</h4>
                        <p>和小秋聊聊音乐，特别是摇滚和Vocaloid，她会分享自己喜欢的曲子和背后的故事</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-gamepad"></i>
                        <h4>游戏动漫讨论</h4>
                        <p>分享你最近在玩的游戏或看的动漫，小秋总能跟上话题，甚至给你推荐类似的作品</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-magic"></i>
                        <h4>情绪陪伴</h4>
                        <p>开心时分享喜悦，低落时寻求安慰，小秋会用温暖的话语和可爱的表情包陪伴你</p>
                    </div>
                </div>
            </section>

            <!-- 邀请区域 -->
            <section class="invite-section">
                <h3><i class="fas fa-user-plus"></i> 邀请小秋</h3>
                <div class="invite-content">
                    <p>想要邀请小秋加入你的QQ群或成为好友吗？请仔细阅读以下信息：</p>
                    
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fab fa-qq"></i>
                            <div>
                                <strong>机器人QQ号:</strong> 2114773985
                            </div>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-user-cog"></i>
                            <div>
                                <strong>开发者QQ号:</strong> 2785185004
                            </div>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>开发者邮箱:</strong> speedmod@163.com
                            </div>
                        </div>
                    </div>
                    
                    <div class="warning">
                        <p><strong>请注意：</strong>添加机器人好友需要密码，请联系开发人员获取。所有聊天内容可能会被用于机器人学习人类聊天风格，以改进对话质量。我们承诺会严格保护用户隐私，所有数据仅用于技术优化。</p>
                    </div>
                    
                    <h4>用户守则：</h4>
                    <ul>
                        <li>请勿使用机器人进行任何违法或违规活动</li>
                        <li>尊重机器人及其他用户，保持友好交流氛围</li>
                        <li>避免发送大量重复或无意义消息</li>
                        <li>请勿尝试攻击或破解机器人系统</li>
                        <li>理解机器人可能存在的响应延迟或错误</li>
                        <li>请勿向机器人发送敏感个人信息</li>
                        <li>鼓励积极健康的交流，避免过度负能量</li>
                    </ul>
                    
                    <p>小秋期待与你的相遇，一起开启有趣的聊天旅程吧！无论你是想找个聊天伙伴，分享音乐动漫，还是仅仅想有个人听你说说话，小秋都会在这里等待。</p>
                </div>
            </section>

            <!-- 页脚 -->
            <footer class="footer">
                <p>© 2025~2026 花咲一秋QQ机器人项目. 保留所有权利.</p>
                <p>本页面由 <strong>卡秋KArabella和支持此项目的早期伙伴们</strong> 开发维护</p>
                <p>本页面仅为介绍页面，机器人功能以实际可用为准</p>
                <p>感谢每一位支持此项目的用户，你们的反馈让小秋变得更好</p>
                
            </footer>
        </div>
    </div>

    <script>
        // 主题切换脚本（在 index 页面）
        (function(){
            const toggle = document.getElementById('theme-toggle');
            if(!toggle) return;
            const root = document.documentElement;
            const stored = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const initTheme = stored || (prefersDark ? 'dark' : 'light');
            // 支持： 'light' | 'dark' | 'high-contrast' | 'auto'
            function applyThemeFromPref(pref){
                if(!pref || pref === 'auto'){
                    const sys = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                    root.setAttribute('data-theme', sys);
                } else {
                    root.setAttribute('data-theme', pref);
                }
            }
            applyThemeFromPref(initTheme === 'auto' ? null : initTheme);
            function updateIcon(){
                const t = root.getAttribute('data-theme');
                if(t === 'dark') toggle.innerHTML = '<i class="fas fa-sun"></i>';
                else if(t === 'high-contrast') toggle.innerHTML = '<i class="fas fa-adjust"></i>';
                else toggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
            toggle.addEventListener('click', ()=>{
                // 点击在 light/dark 之间切换（但不会取消 high-contrast）
                const cur = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
                root.setAttribute('data-theme', cur);
                localStorage.setItem('theme', cur);
                updateIcon();
            });
            // 高对比开关
            const contrastBtn = document.getElementById('contrast-toggle');
            if(contrastBtn){
                function updateContrastBtn(){
                    const cur = localStorage.getItem('theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark':'light');
                    if(cur === 'high-contrast'){ contrastBtn.innerHTML = '<i class="fas fa-adjust"></i>'; contrastBtn.setAttribute('aria-pressed','true'); }
                    else { contrastBtn.innerHTML = '<i class="fas fa-eye"></i>'; contrastBtn.setAttribute('aria-pressed','false'); }
                }
                contrastBtn.addEventListener('click', ()=>{
                    const current = localStorage.getItem('theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark':'light');
                    const next = current === 'high-contrast' ? 'auto' : 'high-contrast';
                    if(next === 'auto') localStorage.removeItem('theme'); else localStorage.setItem('theme', next);
                    applyThemeFromPref(localStorage.getItem('theme') || null);
                    updateIcon();
                    updateContrastBtn();
                });
                updateContrastBtn();
            }
            // 动画开关（强制减少动画）
            const motionBtn = document.getElementById('motion-toggle');
            function applyMotionPref(){
                const storedM = localStorage.getItem('reduceMotion');
                if(storedM === '1') document.documentElement.classList.add('reduced-motion');
                else if(storedM === '0') document.documentElement.classList.remove('reduced-motion');
                else {
                    if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) document.documentElement.classList.add('reduced-motion');
                }
            }
            if(motionBtn){
                function updateMotionBtn(){
                    const cur = localStorage.getItem('reduceMotion');
                    if(cur === '1' || (cur === null && window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches)){
                        motionBtn.innerHTML = '<i class="fas fa-ban"></i>';
                        motionBtn.setAttribute('aria-pressed','true');
                    } else {
                        motionBtn.innerHTML = '<i class="fas fa-bolt"></i>';
                        motionBtn.setAttribute('aria-pressed','false');
                    }
                }
                motionBtn.addEventListener('click', ()=>{
                    const cur = localStorage.getItem('reduceMotion');
                    if(cur === '1'){ localStorage.setItem('reduceMotion','0'); } else { localStorage.setItem('reduceMotion','1'); }
                    applyMotionPref();
                    updateMotionBtn();
                });
                updateMotionBtn();
            }
            applyMotionPref();
            updateIcon();
        })();

        // 回到顶部 & 浮动心样式逻辑
        (function(){
            const btn = document.getElementById('back-to-top');
            const heart = document.getElementById('floating-heart');
            if(btn){
                btn.style.cssText = 'position:fixed;right:20px;bottom:24px;width:48px;height:48px;border-radius:12px;border:none;background:var(--primary-blue);color:#fff;font-size:20px;cursor:pointer;box-shadow:0 12px 30px rgba(0,0,0,0.18);z-index:999;';
                window.addEventListener('scroll', ()=>{ btn.style.display = window.scrollY>200 ? 'block' : 'none'; });
                btn.addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));
            }
            if(heart){
                heart.style.cssText = 'position:fixed;left:24px;bottom:24px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--accent-pink),var(--primary-blue));box-shadow:0 12px 40px rgba(106,147,201,0.18);z-index:998;animation:heartPulse 1500ms infinite;cursor:pointer;';
                heart.addEventListener('click', ()=>{
                    heart.animate([{transform:'scale(1)'},{transform:'scale(1.2)'},{transform:'scale(1)'}],{duration:420});
                });
            }
            const s = document.createElement('style'); s.textContent='@keyframes heartPulse{0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)}}'; document.head.appendChild(s);
        })();
    </script>
    <!-- 预加载与运行时长脚本 -->
    <script>
        // ===================== 预加载动画逻辑（index 页面） =====================
        (function(){
            try{
                var textWrapper = document.querySelector('.preloader .ml13');
                if(textWrapper){
                    var words = textWrapper.textContent.trim().split(' ');
                    textWrapper.innerHTML = '';
                    words.forEach(function(word){
                        var wordSpan = document.createElement('span'); wordSpan.className='word';
                        wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
                        textWrapper.appendChild(wordSpan); textWrapper.appendChild(document.createTextNode(' '));
                    });

                    // 使用 example.html 中完全相同的动画序列（字母滑入淡入，滑出淡出）
                    // Respect prefers-reduced-motion: if set, skip detailed anim and hide preloader soon
                    var reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                    if(reduceMotion){
                        // reveal letters statically and hide preloader shortly
                        var letters = document.querySelectorAll('.preloader .letter');
                        letters.forEach(function(l){ l.style.opacity = '1'; l.style.transform = 'translateY(0)'; });
                        setTimeout(function(){ try{ hidePreloader(); }catch(e){} }, 700);
                    } else {
                        var animation = anime.timeline({ loop: true })
                        .add({
                            targets: '.preloader .letter',
                            translateY: [20, 0],
                            translateZ: 0,
                            opacity: [0, 1],
                            filter: ['blur(5px)', 'blur(0px)'],
                            easing: 'easeOutExpo',
                            duration: 1200,
                            delay: (el, i) => 300 + 20 * i,
                        })
                        .add({
                            targets: '.preloader .letter',
                            translateY: [0, -20],
                            opacity: [1, 0],
                            filter: ['blur(0px)', 'blur(5px)'],
                            easing: 'easeInExpo',
                            duration: 1000,
                            delay: (el, i) => 15 * i,
                            complete: function() { try{ hidePreloader(); }catch(e){} }
                        }, '-=700');
                    }
                }
            }catch(e){console.error(e)}

            // 隐藏 preloader 的兜底逻辑
            function hidePreloader(){
                var el = document.getElementById('preloader'); if(!el) return;
                el.style.opacity = '0';
                setTimeout(function(){ el.style.display='none'; }, 400);
            }
            window.addEventListener('load', function(){ setTimeout(hidePreloader, 5000); });
            // 10s 兜底
            setTimeout(hidePreloader, 10000);
        })();

        // ===================== 运行时长统计（shared） =====================
        (function(){
            const blogStartDate = new Date(2025,9,28,0,0,0); // 起始日期
            let lastAnnivCount = null;

            function odometer_init(){
                document.querySelectorAll('.odometer').forEach(e=>{ try{ new Odometer({ el: e, format: '(ddd)', duration: 200 }); }catch(err){} });
            }

            function animateNumber(el){
                if(!el) return;
                el.classList.remove('pop');
                // force reflow
                void el.offsetWidth;
                el.classList.add('pop');
                setTimeout(()=> el.classList.remove('pop'), 600);
            }

            function playFireworks(){
                const container = document.getElementById('fw');
                if(!container) return;
                const colors = ['#ff5e7f','#ffd166','#8fd3ff','#9be28f','#d6a4ff'];
                const count = 18;
                for(let i=0;i<count;i++){
                    const n = document.createElement('div');
                    n.className = 'confetti';
                    n.style.left = (20 + Math.random()*280) + 'px';
                    n.style.top = (8 + Math.random()*30) + 'px';
                    n.style.background = colors[Math.floor(Math.random()*colors.length)];
                    n.style.opacity = '1';
                    const dur = 900 + Math.floor(Math.random()*600);
                    n.style.transition = `transform ${dur}ms cubic-bezier(.2,.8,.2,1), opacity ${dur}ms linear`;
                    container.appendChild(n);
                    // trigger animation
                    setTimeout(()=>{
                        const tx = (Math.random()*160 - 80) + 'px';
                        n.style.transform = `translate(${tx}, ${120 + Math.random()*40}px) rotate(${Math.random()*720}deg)`;
                        n.style.opacity = '0';
                    }, 10 + Math.random()*80);
                    // cleanup
                    setTimeout(()=>{ try{ container.removeChild(n); }catch(e){} }, dur+250);
                }
            }

            function updateRuntimeAndAnniv(){
                const now = new Date(); const diff = now - blogStartDate;
                const seconds = Math.floor((diff/1000)%60);
                const minutes = Math.floor((diff/(1000*60))%60);
                const hours = Math.floor((diff/(1000*60*60))%24);
                const days = Math.floor(diff/(1000*60*60*24));
                const d = document.getElementById('runtime_days'); const h = document.getElementById('runtime_hours');
                const m = document.getElementById('runtime_minutes'); const s = document.getElementById('runtime_seconds');
                if(d && String(d.innerText) !== String(days)){ d.innerText = days; animateNumber(d); }
                if(h && String(h.innerText) !== String(hours)){ h.innerText = hours; animateNumber(h); }
                if(m && String(m.innerText) !== String(minutes)){ m.innerText = minutes; animateNumber(m); }
                if(s && String(s.innerText) !== String(seconds)){ s.innerText = seconds; animateNumber(s); }

                // Anniversary progress: years passed since blogStartDate
                const start = new Date(blogStartDate.getTime());
                let years = now.getFullYear() - start.getFullYear();
                let last = new Date(start.getTime()); last.setFullYear(start.getFullYear() + years);
                if(now < last){ years -= 1; last.setFullYear(start.getFullYear() + years); }
                const next = new Date(last.getTime()); next.setFullYear(last.getFullYear() + 1);
                const annivCount = Math.max(0, years);
                const annivEl = document.getElementById('anniv-count');
                if(annivEl && String(annivEl.textContent) !== String(annivCount)){
                    annivEl.textContent = annivCount; animateNumber(annivEl);
                }
                const fillEl = document.getElementById('anniv-fill');
                    if(fillEl){
                        const total = next - last;
                        const elapsed = now - last;
                        const pct = total > 0 ? Math.max(0, Math.min(1, elapsed/total)) : 0;
                        fillEl.style.width = (pct*100) + '%';
                        // 更新百分比显示（保留两位小数）
                        const pctEl = document.getElementById('anniv-percent');
                        if(pctEl) pctEl.textContent = (pct*100).toFixed(2) + '%';
                        const colors = ['#6a93c9','#ffcc66','#8fd3ff','#ff99cc','#9be28f','#d6a4ff'];
                        const color = colors[annivCount % colors.length];
                        fillEl.style.background = color;
                    }

                // detect anniversary crossing while page open
                if(lastAnnivCount === null) lastAnnivCount = annivCount;
                else if(annivCount > lastAnnivCount){
                    // celebrate
                    playFireworks();
                    lastAnnivCount = annivCount;
                } else {
                    lastAnnivCount = annivCount;
                }
            }

            document.addEventListener('DOMContentLoaded', ()=>{
                odometer_init(); updateRuntimeAndAnniv(); setInterval(updateRuntimeAndAnniv, 1000);
                
                // 修复：在 DOMContentLoaded 中初始化音乐播放器
                // ===================== 修复的音乐播放器初始化 =====================
                // 简单初始化，让 meting-js 的 autoplay 参数生效
                document.addEventListener('DOMContentLoaded', function() {
                    // 等待页面完全加载
                    setTimeout(function() {
                        const aplayer = window.aplayers && window.aplayers[0];
                        if (aplayer) {
                            // 设置默认音量
                            try {
                                aplayer.volume(0.15);
                                console.log('音乐播放器音量设置为 15%');
                            } catch(e) {
                                console.warn('设置音量失败:', e);
                            }
                            
                            // 如果 autoplay 失败，显示提示
                            aplayer.on('play', function() {
                                console.log('音乐开始播放');
                            });
                            
                            aplayer.on('error', function() {
                                console.warn('音乐播放错误，可能需要用户交互');
                            });
                        }
                    }, 1000);
                });
            });
        })();
        
        // ===================== 修复的音乐播放器初始化 =====================
        function initMetingPlayerWithAutoplay() {
            console.log('初始化音乐播放器（带自动播放）...');
            
            // 等待页面完全加载后初始化播放器
            window.addEventListener('load', function() {
                setTimeout(function() {
                    const metingEl = document.querySelector('meting-js');
                    if (!metingEl) {
                        console.warn('未找到 meting-js 元素');
                        return;
                    }
                    
                    // 等待 APlayer 实例创建
                    const checkInterval = setInterval(function() {
                        const aplayer = window.aplayers && window.aplayers[0];
                        if (aplayer) {
                            clearInterval(checkInterval);
                            console.log('APlayer 实例已找到，开始配置自动播放...');
                            
                            // 设置默认音量为 15%
                            try {
                                aplayer.volume(0.15);
                                console.log('音量已设置为 15%');
                            } catch(e) {
                                console.warn('设置音量失败:', e);
                            }
                            
                            // 随机选择一首歌曲
                            const songCount = aplayer.list.audios.length;
                            if (songCount > 0) {
                                const randomIndex = Math.floor(Math.random() * songCount);
                                console.log(`从 ${songCount} 首歌曲中随机选择第 ${randomIndex + 1} 首`);
                                
                                // 切换到随机歌曲
                                aplayer.switch(randomIndex);
                                
                                // 延迟播放（等待切换完成）
                                setTimeout(function() {
                                    // 尝试自动播放
                                    const playPromise = aplayer.play();
                                    
                                    if (playPromise !== undefined) {
                                        playPromise.then(function() {
                                            console.log('自动播放成功');
                                            
                                            // 显示当前播放歌曲信息
                                            const currentSong = aplayer.list.audios[randomIndex];
                                            showMusicPopup(currentSong);
                                        }).catch(function(error) {
                                            console.log('自动播放被浏览器阻止:', error);
                                            
                                            // 显示启用按钮
                                            const currentSong = aplayer.list.audios[randomIndex];
                                            showMusicPopup(currentSong, true);
                                        });
                                    }
                                }, 500);
                            }
                            
                            // 监听歌曲切换事件
                            aplayer.on('switch', function() {
                                const currentIndex = aplayer.list.index;
                                const currentSong = aplayer.list.audios[currentIndex];
                                console.log('歌曲切换到:', currentSong.name);
                                showMusicPopup(currentSong);
                            });
                            
                            // 监听播放事件
                            aplayer.on('play', function() {
                                const currentIndex = aplayer.list.index;
                                const currentSong = aplayer.list.audios[currentIndex];
                                console.log('开始播放:', currentSong.name);
                            });
                        }
                    }, 100);
                    
                    // 超时停止检查
                    setTimeout(function() {
                        clearInterval(checkInterval);
                    }, 10000);
                }, 1000); // 延迟1秒，确保所有资源加载完成
            });
        }
        
        // 显示歌曲信息弹窗
        function showMusicPopup(song, showEnableBtn = false) {
            if (!song) return;
            
            console.log('显示歌曲信息:', song);
            
            // 创建或获取弹窗元素
            let popup = document.getElementById('musicPopup');
            if (!popup) {
                popup = document.createElement('div');
                popup.id = 'musicPopup';
                popup.className = 'music-popup';
                document.body.appendChild(popup);
            }
            
            // 清除之前的定时器
            if (popup.hideTimer) {
                clearTimeout(popup.hideTimer);
                popup.hideTimer = null;
            }
            
            // 构建弹窗内容
            const title = song.name || '未知曲目';
            const artist = song.artist || song.author || '未知艺术家';
            
            let content = `
                <div style="font-weight:700;margin-bottom:6px;font-size:14px;">即将播放：${escapeHtml(title)}</div>
                <div style="font-size:12px;color:var(--muted)">演唱/作者：${escapeHtml(artist)}</div>
            `;
            
            if (showEnableBtn) {
                content += `
                    <button id="enableMusicBtn" style="margin-top:8px;padding:6px 12px;border-radius:6px;border:none;background:var(--primary-blue);color:#fff;cursor:pointer;font-size:12px;">
                        启用声音并播放
                    </button>
                `;
            }
            
            popup.innerHTML = content;
            
            // 强制重排确保 CSS 过渡生效
            void popup.offsetWidth;
            popup.classList.add('show');
            
            // 添加启用按钮事件监听
            if (showEnableBtn) {
                const enableBtn = document.getElementById('enableMusicBtn');
                if (enableBtn) {
                    enableBtn.addEventListener('click', function() {
                        const aplayer = window.aplayers && window.aplayers[0];
                        if (aplayer) {
                            aplayer.play().catch(function(error) {
                                console.warn('播放失败:', error);
                            });
                        }
                        popup.classList.remove('show');
                    }, { once: true });
                }
            }
            
            // 设置自动隐藏定时器（如果不显示启用按钮）
            if (!showEnableBtn) {
                popup.hideTimer = setTimeout(function() {
                    popup.classList.remove('show');
                }, 3000);
            }
        }
        
        // HTML 转义函数
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
    </script>

    <!-- 右上隐藏控件：音乐播放器卡片（鼠标悬停或点击头部展开） -->
    <div class="music-widget" id="musicWidget" aria-label="音乐播放器" role="region" aria-hidden="true" tabindex="-1">
        <div class="music-header" id="musicToggle" role="button" aria-expanded="false">
            <div style="display:flex;align-items:center;gap:10px">
                <i class="fa fa-music" aria-hidden="true"></i>
                <div class="title">音乐播放器</div>
            </div>
            <div style="font-size:12px;color:var(--muted)">悬停展开或点击控制</div>
        </div>
        <div class="music-body" id="musicBody">
            <meting-js server="netease" type="playlist" id="5034562952" autoplay="true"></meting-js>
        </div>
    </div>

    <!-- 右下堆栈控件：运行时长小组件（保持右下） -->
    <div class="widget-stack" aria-hidden="false">
        <div class="runtime-widget" role="note" aria-label="花咲一秋项目运行与周年进度">
            <div class="anniv-row">
                <div style="display:flex;align-items:center">
                    <div class="anniv-label">周年进度 Anniversary </div>
                    <div id="anniv-count" class="anniv-count">0</div>
                </div>
                <div id="anniv-percent" style="font-size:14px;color:var(--muted);font-weight:700">0%</div>
            </div>
            <div class="progress-track" aria-hidden="true">
                <div id="anniv-fill" class="progress-fill" style="width:0%"></div>
                <div class="progress-overlay">
                    <div style="display:flex;align-items:center;gap:8px">
                        <span class="runtime-label"></span>
                        <span id="runtime_days" class="odometer">0</span>
                        <span class="runtime-label">d</span>
                        <span id="runtime_hours" class="odometer">0</span>
                        <span class="runtime-label">h</span>
                        <span id="runtime_minutes" class="odometer">0</span>
                        <span class="runtime-label">m</span>
                        <span id="runtime_seconds" class="odometer">0</span>
                        <span class="runtime-label">s</span>
                    </div>
                </div>
            </div>
            <div class="fw-container" id="fw"></div>
        </div>
    </div>

    <script>
        // Animation diagnostics: detect anime.js availability and record errors for HTTPS debugging
        (function(){
            window.__hanasaki_diag = window.__hanasaki_diag || {};
            window.__hanasaki_diag.errors = window.__hanasaki_diag.errors || [];
            window.addEventListener('error', function(ev){ try{ window.__hanasaki_diag.errors.push({ message: ev.message, filename: ev.filename, lineno: ev.lineno }); }catch(e){} });
            function testAnime(){ try{
                    if(window.anime && typeof window.anime === 'function'){
                        // try a trivial animation on a transient element
                        var t = document.createElement('div'); t.id='anime-diagnostic'; t.style.cssText='position:fixed;left:-9999px;top:-9999px;width:10px;height:10px;'; document.body.appendChild(t);
                        try{ anime({ targets: t, translateX: [0, 10], duration: 120, complete: function(){ try{ document.body.removeChild(t); window.__hanasaki_diag.anime = 'ok'; }catch(e){} } }); }catch(e){ window.__hanasaki_diag.anime = 'error'; window.__hanasaki_diag.errors.push({message: e.message}); }
                    } else {
                        window.__hanasaki_diag.anime = 'missing';
                        // attempt to dynamically load a fallback CDN
                        var s = document.createElement('script'); s.src = 'https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js'; s.onload = function(){ window.__hanasaki_diag.anime = 'loaded-fallback'; testAnime(); }; s.onerror = function(){ window.__hanasaki_diag.anime = 'fallback-failed'; window.__hanasaki_diag.errors.push({message:'failed to load fallback anime'}); };
                        document.head.appendChild(s);
                    }
                }catch(err){ try{ window.__hanasaki_diag.errors.push({message:err.message}); }catch(e){} }
            }
            // run after load to capture possible CSP/network blocking
            window.addEventListener('load', function(){ setTimeout(testAnime, 200); });
        })();
    </script>
    <script>
        // Global focus-trap utility (lightweight) used by navbar drawer and music widget
        function trapFocusIn(container){
            if(!container) return;
            try{
                var previous = document.activeElement;
                var focusables = container.querySelectorAll('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
                if(!focusables || focusables.length === 0) return;
                focusables[0].focus();
                var first = focusables[0];
                var last = focusables[focusables.length - 1];
                function keyHandler(e){
                    if(e.key === 'Tab'){
                        if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
                        else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
                    } else if(e.key === 'Escape' || e.key === 'Esc'){
                        e.preventDefault(); // close logical container if it supports class toggles
                        try{ container.classList.remove('open'); container.classList.remove('show'); }catch(err){}
                        document.removeEventListener('keydown', keyHandler);
                    }
                }
                document.addEventListener('keydown', keyHandler);
                var mo = new MutationObserver(function(){ if(!container.classList.contains('open') && !container.classList.contains('show')){ try{ document.removeEventListener('keydown', keyHandler); }catch(e){} mo.disconnect(); } });
                mo.observe(container, { attributes: true, attributeFilter: ['class'] });
            }catch(e){}
        }
    </script>
</body>
</html>